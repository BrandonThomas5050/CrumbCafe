<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>Crumb Caf√© üêøÔ∏è</title>
<link rel="preconnect" href="https://fonts.googleapis.com"/>
<link href="https://fonts.googleapis.com/css2?family=Caveat:wght@400;500;600;700&family=Fredoka+One&family=Nunito:wght@400;500;600;700;800&family=Patrick+Hand&display=swap" rel="stylesheet"/>

<style>
:root {
  --brown1: #7a5248;
  --brown2: #5a2d00;
  --brown3: #8B3A00;
  --brown4: #8B4513;
  --brown5: #4a3728;
  --warm:   #c97a3a;
  --cream:  #fdf6ec;
  --light:  #f5e6d3;
  --white:  #ffffff;
  --black:  #1a0f0a;
  --accent: #d4622a;
}
*{margin:0;padding:0;box-sizing:border-box;}
html{scroll-behavior:smooth;}
body{
  font-family:'Nunito',sans-serif;
  background:var(--cream);
  color:var(--brown5);
  overflow-x:hidden;
  cursor:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='24' height='24' viewBox='0 0 24 24'%3E%3Ccircle cx='12' cy='12' r='5' fill='%238B3A00' opacity='0.7'/%3E%3C/svg%3E") 12 12,auto;
}
body::before{
  content:'';
  position:fixed;inset:0;z-index:-1;
  background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='60' height='60'%3E%3Ccircle cx='10' cy='10' r='2' fill='%238B451340'/%3E%3Ccircle cx='50' cy='30' r='1.5' fill='%237a524840'/%3E%3Ccircle cx='30' cy='50' r='1' fill='%238B3A0030'/%3E%3C/svg%3E");
  pointer-events:none;
}
.font-title{font-family:'Fredoka One',cursive;}
.font-hand {font-family:'Caveat',cursive;}
.font-sub  {font-family:'Patrick Hand',cursive;}

/* LOADING */
#loading-screen{position:fixed;inset:0;background:var(--brown2);z-index:9999;display:flex;flex-direction:column;align-items:center;justify-content:center;transition:opacity 0.6s ease;}
#loading-screen.hidden{opacity:0;pointer-events:none;}
.load-sq{font-size:5rem;display:block;animation:loadSq 0.6s ease-in-out infinite alternate;filter:drop-shadow(0 8px 20px rgba(0,0,0,0.4));}
@keyframes loadSq{from{transform:translateY(0) rotate(-5deg);}to{transform:translateY(-15px) rotate(5deg);}}
.loading-text{font-family:'Fredoka One',cursive;font-size:2.8rem;color:var(--cream);letter-spacing:4px;margin-top:24px;text-shadow:3px 3px 0 var(--brown4);}
.loading-sub{font-family:'Caveat',cursive;font-size:1.4rem;color:rgba(255,255,255,0.6);margin-top:8px;}
.crumb-trail-load{display:flex;gap:12px;margin-top:28px;}
.crumb-dot{width:12px;height:12px;background:var(--warm);border-radius:50%;animation:crumbBounce 0.8s ease-in-out infinite;}
.crumb-dot:nth-child(2){animation-delay:0.15s;}
.crumb-dot:nth-child(3){animation-delay:0.3s;}
.crumb-dot:nth-child(4){animation-delay:0.45s;}
.crumb-dot:nth-child(5){animation-delay:0.6s;}
@keyframes crumbBounce{0%,100%{transform:translateY(0);opacity:0.4;}50%{transform:translateY(-10px);opacity:1;}}
.progress-bar-outer{width:220px;height:6px;background:rgba(255,255,255,0.15);border-radius:999px;margin-top:20px;overflow:hidden;}
.progress-bar-inner{height:100%;background:var(--warm);border-radius:999px;width:0%;transition:width 0.03s linear;}

/* NAVBAR */
nav{position:fixed;top:0;left:0;right:0;z-index:100;height:70px;display:flex;align-items:center;justify-content:space-between;padding:0 2rem;transition:all 0.4s;}
nav.scrolled{background:var(--cream);box-shadow:0 4px 0 var(--brown4);border-bottom:3px solid var(--brown4);}
.nav-logo{display:flex;align-items:center;gap:10px;text-decoration:none;cursor:pointer;}
.squirrel-logo-img{width:48px;height:48px;object-fit:cover;animation:squirrelWiggle 3s ease-in-out infinite;filter:drop-shadow(2px 2px 4px rgba(0,0,0,0.2));border-radius:50%;}
@keyframes squirrelWiggle{0%,100%{transform:rotate(0deg) scale(1);}15%{transform:rotate(-8deg) scale(1.05);}30%{transform:rotate(5deg) scale(1.02);}45%{transform:rotate(-3deg) scale(1.04);}60%{transform:rotate(2deg) scale(1);}}
.nav-logo-text{font-family:'Fredoka One',cursive;font-size:1.6rem;color:var(--brown2);text-shadow:2px 2px 0 var(--warm);}
.nav-links{display:flex;align-items:center;gap:8px;}
.nav-link{font-family:'Caveat',cursive;font-size:1.3rem;font-weight:700;color:var(--brown2);text-decoration:none;padding:6px 18px;border-radius:999px;border:2.5px solid transparent;transition:all 0.2s;}
.nav-link:hover,.nav-link.active{background:var(--brown4);color:var(--white);border-color:var(--brown5);transform:rotate(-1deg) scale(1.05);}
.nav-cta{font-family:'Fredoka One',cursive;font-size:1.1rem;background:var(--accent);color:white;padding:10px 24px;border-radius:999px;text-decoration:none;border:3px solid var(--brown5);box-shadow:4px 4px 0 var(--brown5);transition:all 0.2s;}
.nav-cta:hover{transform:translate(-2px,-2px);box-shadow:6px 6px 0 var(--brown5);}
.hamburger{display:none;flex-direction:column;gap:5px;cursor:pointer;padding:4px;}
.hamburger span{width:24px;height:3px;background:var(--brown2);border-radius:2px;transition:all 0.3s;}
.mobile-menu{display:none;position:fixed;top:70px;left:0;right:0;background:var(--cream);padding:16px;border-bottom:3px solid var(--brown4);z-index:99;box-shadow:0 8px 24px rgba(0,0,0,0.15);}
.mobile-menu.open{display:block;}
.mobile-link{display:block;padding:12px 16px;border-radius:12px;text-decoration:none;font-family:'Caveat',cursive;font-size:1.3rem;font-weight:700;color:var(--brown2);margin-bottom:4px;transition:background 0.2s;}
.mobile-link:hover,.mobile-link.active{background:var(--brown4);color:white;}
.mobile-cta{display:block;padding:12px 16px;border-radius:12px;text-decoration:none;background:var(--accent);color:white;font-family:'Fredoka One',cursive;font-size:1.1rem;text-align:center;margin-top:8px;border:2px solid var(--brown5);}

/* PAGE SYSTEM */
.page{display:none;min-height:100vh;}
.page.active{display:block;}
@keyframes fadeUp{from{opacity:0;transform:translateY(24px);}to{opacity:1;transform:translateY(0);}}
.page-enter{animation:fadeUp 0.4s ease forwards;}

/* HERO */
.hero{min-height:100vh;background:var(--brown2);position:relative;overflow:hidden;display:flex;align-items:center;padding-top:70px;}
.hero-doodles{position:absolute;inset:0;pointer-events:none;}
.doodle-acorn-1{position:absolute;top:12%;right:4%;font-size:3.5rem;animation:floatBob 4s ease-in-out infinite;filter:drop-shadow(0 8px 16px rgba(0,0,0,0.3));opacity:0.5;}
.doodle-acorn-2{position:absolute;bottom:20%;left:3%;font-size:2.5rem;animation:floatBob 5s ease-in-out infinite 1s;opacity:0.35;}
.doodle-acorn-3{position:absolute;top:70%;right:48%;font-size:2rem;animation:floatBob 3.5s ease-in-out infinite 0.5s;opacity:0.25;}
@keyframes floatBob{0%,100%{transform:translateY(0) rotate(-5deg);}50%{transform:translateY(-18px) rotate(5deg);}}
.hero-squirrel-art{position:absolute;right:-20px;top:50%;transform:translateY(-50%);opacity:0.45;font-size:30rem;pointer-events:none;line-height:1;filter:drop-shadow(0 0 80px rgba(201,122,58,0.45));animation:squirrelFloat 5s ease-in-out infinite;}
@media(max-width:900px){.hero-squirrel-art{right:auto;left:50%;top:50%;transform:translate(-50%,-50%);opacity:0.22;font-size:22rem;}}
@media(max-width:480px){.hero-squirrel-art{opacity:0.16;font-size:15rem;}}
.hero-content{position:relative;z-index:2;max-width:1100px;margin:0 auto;padding:80px 2rem 60px;width:100%;}
.hero-text-side{max-width:580px;}
.hero-badge{display:inline-block;background:var(--warm);color:white;font-family:'Caveat',cursive;font-size:1.2rem;padding:6px 20px;border-radius:999px;border:2.5px solid rgba(255,255,255,0.3);margin-bottom:20px;transform:rotate(-1.5deg);box-shadow:3px 3px 0 rgba(0,0,0,0.2);}
.hero-title{font-family:'Fredoka One',cursive;font-size:clamp(3rem,6vw,5.5rem);color:var(--cream);line-height:1.05;margin-bottom:16px;text-shadow:5px 5px 0 var(--brown4),6px 6px 0 rgba(0,0,0,0.2);}
.hero-title .accent{color:var(--warm);}
.hero-desc{font-family:'Patrick Hand',cursive;font-size:1.2rem;color:rgba(253,246,236,0.8);line-height:1.7;margin-bottom:32px;}
.hero-btns{display:flex;gap:14px;flex-wrap:wrap;}
.btn-primary{font-family:'Fredoka One',cursive;font-size:1.15rem;background:var(--cream);color:var(--brown2);padding:13px 28px;border-radius:999px;border:3px solid var(--brown5);box-shadow:5px 5px 0 var(--brown5);text-decoration:none;cursor:pointer;transition:all 0.15s;display:inline-flex;align-items:center;gap:8px;}
.btn-primary:hover{transform:translate(-3px,-3px);box-shadow:8px 8px 0 var(--brown5);}
.btn-secondary{font-family:'Fredoka One',cursive;font-size:1.15rem;background:var(--accent);color:white;padding:13px 28px;border-radius:999px;border:3px solid var(--brown5);box-shadow:5px 5px 0 var(--brown5);text-decoration:none;cursor:pointer;transition:all 0.15s;display:inline-flex;align-items:center;gap:8px;}
.btn-secondary:hover{transform:translate(-3px,-3px);box-shadow:8px 8px 0 var(--brown5);}
.hero-stats{display:flex;gap:24px;margin-top:40px;flex-wrap:wrap;}
.stat-card{background:rgba(255,255,255,0.1);border:2px solid rgba(255,255,255,0.2);border-radius:16px;padding:12px 18px;transform:rotate(-1deg);transition:transform 0.2s;backdrop-filter:blur(4px);}
.stat-card:nth-child(2){transform:rotate(1.5deg);}
.stat-card:nth-child(3){transform:rotate(-0.5deg);}
.stat-card:hover{transform:rotate(0) scale(1.05)!important;}
.stat-num{font-family:'Fredoka One',cursive;font-size:2rem;color:var(--warm);}
.stat-label{font-family:'Caveat',cursive;font-size:1rem;color:rgba(253,246,236,0.65);}
@keyframes spin{to{transform:rotate(360deg);}}
@keyframes squirrelFloat{0%,100%{transform:translateY(-50%) rotate(-2deg);}50%{transform:translateY(calc(-50% - 18px)) rotate(2deg);}}
.hero-crumb-trail{position:absolute;bottom:40px;left:0;right:0;display:flex;justify-content:center;gap:16px;pointer-events:none;}
.trail-dot{width:8px;height:8px;background:rgba(255,255,255,0.3);border-radius:50%;animation:trailPulse 2s ease-in-out infinite;}
.trail-dot:nth-child(odd){animation-delay:0.5s;background:var(--warm);opacity:0.5;}
@keyframes trailPulse{0%,100%{opacity:0.3;transform:scale(1);}50%{opacity:0.8;transform:scale(1.3);}}

/* WAVE */
.wave-div{width:100%;overflow:hidden;line-height:0;margin-top:-2px;}
.wave-div svg{width:100%;height:60px;}

/* SHARED SECTIONS */
.section{padding:80px 2rem;position:relative;}
.section-inner{max-width:1100px;margin:0 auto;}
.eyebrow{font-family:'Caveat',cursive;font-size:1.4rem;color:var(--warm);margin-bottom:8px;display:block;transform:rotate(-1deg);}
.section-title{font-family:'Fredoka One',cursive;font-size:clamp(2rem,4vw,3.2rem);color:var(--brown2);line-height:1.15;margin-bottom:16px;}
.section-title .accent{color:var(--accent);}
.section-body{font-size:1.05rem;line-height:1.75;color:var(--brown5);margin-bottom:16px;}

/* WHY CRUMB */
.why-section{background:var(--cream);padding:100px 2rem;position:relative;overflow:hidden;}
.why-grid{display:grid;grid-template-columns:1fr 1fr;gap:60px;align-items:center;margin-bottom:60px;}
.feature-cards{display:grid;grid-template-columns:repeat(4,1fr);gap:16px;}
.feature-card{background:white;border-radius:24px;padding:24px 18px;border:3px solid var(--brown4);box-shadow:6px 6px 0 var(--brown4);transition:all 0.2s;cursor:default;}
.feature-card:hover{transform:translate(-3px,-3px)!important;box-shadow:9px 9px 0 var(--brown4);}
.feature-card:nth-child(odd){transform:rotate(-1.5deg);}
.feature-card:nth-child(even){transform:rotate(1deg);}
.feature-icon{font-size:2.4rem;margin-bottom:10px;}
.feature-title{font-family:'Fredoka One',cursive;font-size:1.1rem;color:var(--brown2);margin-bottom:6px;}
.feature-desc{font-size:0.88rem;line-height:1.6;color:var(--brown5);}
.why-squirrel-wrap{display:flex;justify-content:center;align-items:center;position:relative;}
.squirrel-big-anim{font-size:9rem;animation:squirrelDance 3s ease-in-out infinite;filter:drop-shadow(0 16px 32px rgba(90,45,0,0.25));position:relative;z-index:2;}
@keyframes squirrelDance{0%,100%{transform:translateY(0) rotate(-3deg) scale(1);}20%{transform:translateY(-20px) rotate(5deg) scale(1.05);}40%{transform:translateY(-8px) rotate(-2deg) scale(1.02);}60%{transform:translateY(-15px) rotate(4deg) scale(1.04);}80%{transform:translateY(-5px) rotate(-1deg) scale(1.01);}}
.why-squirrel-ring{position:absolute;width:200px;height:200px;border:4px dashed var(--brown4);border-radius:50%;opacity:0.3;animation:spin 20s linear infinite;}
.why-acorn-scatter{position:absolute;font-size:2rem;opacity:0.25;}
.wa1{top:5%;left:10%;}.wa2{top:15%;right:8%;}.wa3{bottom:10%;left:15%;}.wa4{bottom:5%;right:12%;}

/* SPECIAL */
.special-section{background:var(--brown2);padding:80px 2rem;position:relative;overflow:hidden;}
.special-section::before{content:'üå∞üå∞üå∞üå∞üå∞üå∞üå∞üå∞üå∞üå∞üå∞üå∞üå∞üå∞üå∞üå∞üå∞üå∞üå∞üå∞';position:absolute;top:0;left:0;right:0;font-size:1.4rem;letter-spacing:4px;color:rgba(255,255,255,0.05);font-family:monospace;line-height:1.2;pointer-events:none;word-break:break-all;padding:8px;}
.special-card{max-width:880px;margin:0 auto;background:rgba(255,255,255,0.08);border:3px solid rgba(255,255,255,0.15);border-radius:28px;padding:40px;display:flex;align-items:center;gap:36px;flex-wrap:wrap;box-shadow:8px 8px 0 rgba(0,0,0,0.2);position:relative;z-index:1;}
.spinning-badge{width:110px;height:110px;background:var(--accent);border-radius:50%;display:flex;flex-direction:column;align-items:center;justify-content:center;border:4px solid rgba(255,255,255,0.3);flex-shrink:0;position:relative;box-shadow:5px 5px 0 rgba(0,0,0,0.3);}
.spinning-ring{position:absolute;inset:8px;border:2px dashed rgba(255,255,255,0.4);border-radius:50%;animation:spin 12s linear infinite;}
.badge-text-top{color:rgba(255,255,255,0.85);font-family:'Caveat',cursive;font-size:0.8rem;font-weight:700;letter-spacing:0.08em;text-transform:uppercase;z-index:1;}
.badge-text-main{font-family:'Fredoka One',cursive;color:var(--cream);font-size:1.2rem;z-index:1;}
.badge-star{font-size:1.1rem;z-index:1;margin-bottom:2px;}
.special-info{flex:1;min-width:220px;}
.special-name{font-family:'Fredoka One',cursive;font-size:clamp(1.4rem,2.5vw,2rem);color:var(--cream);margin-bottom:8px;}
.special-desc{font-family:'Patrick Hand',cursive;color:rgba(253,246,236,0.7);font-size:1.05rem;margin-bottom:16px;}
.special-pricing{display:flex;align-items:center;gap:14px;flex-wrap:wrap;}
.price-main{font-family:'Fredoka One',cursive;font-size:2.4rem;color:var(--warm);}
.price-old{color:rgba(253,246,236,0.4);font-size:1rem;text-decoration:line-through;}
.price-badge{background:var(--brown4);color:white;padding:4px 14px;border-radius:999px;font-family:'Caveat',cursive;font-size:1rem;font-weight:700;border:2px solid rgba(255,255,255,0.2);}
.special-btn{font-family:'Fredoka One',cursive;font-size:1.1rem;background:var(--cream);color:var(--brown2);padding:14px 28px;border-radius:999px;border:3px solid var(--cream);box-shadow:4px 4px 0 rgba(0,0,0,0.3);cursor:pointer;transition:all 0.2s;white-space:nowrap;text-decoration:none;flex-shrink:0;}
.special-btn:hover{transform:translate(-2px,-2px);box-shadow:6px 6px 0 rgba(0,0,0,0.3);}

/* HOURS */
.hours-section{background:var(--brown4);padding:80px 2rem;position:relative;overflow:hidden;}
.hours-section::after{content:'‚òï ‚òï ‚òï ‚òï ‚òï ‚òï ‚òï';position:absolute;bottom:12px;right:20px;font-size:1.8rem;opacity:0.1;letter-spacing:8px;pointer-events:none;}
.hours-title{font-family:'Fredoka One',cursive;font-size:clamp(2rem,3vw,2.8rem);color:var(--cream);text-align:center;margin-bottom:48px;text-shadow:3px 3px 0 var(--brown5);}
.hours-grid{display:grid;grid-template-columns:1fr 1fr;gap:40px;align-items:start;}
.hours-card{background:var(--cream);border-radius:24px;padding:32px;border:3px solid var(--brown5);box-shadow:8px 8px 0 var(--brown5);position:relative;}
.hours-card::before{content:'üå∞';position:absolute;top:-16px;right:20px;font-size:2rem;transform:rotate(15deg);}
.hours-card-title{font-family:'Fredoka One',cursive;font-size:1.4rem;color:var(--brown2);margin-bottom:8px;}
.hours-card-sub{font-family:'Caveat',cursive;font-size:1.1rem;color:var(--brown4);margin-bottom:24px;}
.time-row{display:flex;align-items:center;justify-content:space-between;padding:14px 16px;background:var(--light);border-radius:14px;margin-bottom:10px;border:2px solid var(--brown4);}
.time-label{font-family:'Patrick Hand',cursive;color:var(--brown5);font-size:1rem;}
.time-val{font-family:'Fredoka One',cursive;font-size:1.5rem;color:var(--brown2);}
.hours-note{background:rgba(139,58,0,0.08);border:2px dashed var(--brown4);border-radius:14px;padding:14px;margin-top:12px;display:flex;gap:10px;}
.note-text{font-size:0.88rem;line-height:1.6;color:var(--brown5);}
.contact-cards{display:flex;flex-direction:column;gap:12px;}
.contact-card{background:rgba(253,246,236,0.12);border:2.5px solid rgba(253,246,236,0.2);border-radius:16px;padding:18px 22px;display:flex;align-items:center;gap:14px;text-decoration:none;transition:all 0.2s;}
.contact-card:hover{background:rgba(253,246,236,0.22);transform:translateX(6px);}
.contact-icon-box{width:42px;height:42px;background:var(--accent);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.1rem;flex-shrink:0;}
.contact-role{font-family:'Fredoka One',cursive;font-size:1rem;color:var(--cream);}
.contact-email{font-family:'Patrick Hand',cursive;color:rgba(253,246,236,0.6);font-size:0.85rem;}
.contact-arrow{color:var(--warm);margin-left:auto;font-size:1.2rem;}

/* QUOTE */
.quote-section{background:var(--cream);padding:80px 2rem;text-align:center;position:relative;overflow:hidden;}
.quote-squirrel-bg{position:absolute;font-size:20rem;opacity:0.04;top:50%;left:50%;transform:translate(-50%,-50%);pointer-events:none;}
.quote-text{font-family:'Fredoka One',cursive;font-size:clamp(2.5rem,5vw,5rem);color:var(--brown2);line-height:1.15;position:relative;text-shadow:4px 4px 0 rgba(139,69,19,0.15);}
.quote-text .accent{color:var(--accent);}
.quote-accent-line{display:flex;align-items:center;justify-content:center;gap:16px;margin-top:32px;}
.quote-line{flex:1;max-width:120px;height:3px;background:var(--brown4);border-radius:999px;}
.quote-acorn{font-size:1.8rem;animation:floatBob 3s ease-in-out infinite;}

/* HOW TO ORDER */
.how-section{padding:80px 2rem;background:var(--light);}
.how-header{text-align:center;margin-bottom:60px;}
.how-sub{font-family:'Patrick Hand',cursive;font-size:1.1rem;color:var(--brown5);max-width:440px;margin:10px auto 0;}
.steps-grid{display:grid;grid-template-columns:repeat(5,1fr);gap:14px;position:relative;}
.step-card{background:white;border-radius:20px;padding:22px 16px;border:3px solid var(--brown4);box-shadow:5px 5px 0 var(--brown4);transition:all 0.2s;position:relative;text-align:center;}
.step-card:nth-child(odd){transform:rotate(-1deg);}
.step-card:nth-child(even){transform:rotate(1.5deg);}
.step-card:hover{transform:rotate(0) translate(-3px,-3px)!important;box-shadow:8px 8px 0 var(--brown4);}
.step-icon-box{width:56px;height:56px;background:var(--brown2);border-radius:16px;display:flex;align-items:center;justify-content:center;font-size:1.4rem;margin:0 auto 10px;border:2px solid var(--brown5);}
.step-num{position:absolute;top:-12px;right:-10px;width:28px;height:28px;background:var(--accent);border-radius:50%;display:flex;align-items:center;justify-content:center;font-family:'Fredoka One',cursive;font-size:0.8rem;color:white;border:2px solid var(--brown5);}
.step-title{font-family:'Fredoka One',cursive;font-size:0.95rem;color:var(--brown2);margin-bottom:6px;}
.step-desc{font-size:0.8rem;line-height:1.55;color:var(--brown5);}
.how-cta{text-align:center;margin-top:48px;}
.btn-green{font-family:'Fredoka One',cursive;font-size:1.2rem;background:var(--brown2);color:var(--cream);padding:16px 40px;border-radius:999px;border:3px solid var(--brown5);box-shadow:6px 6px 0 var(--brown5);cursor:pointer;text-decoration:none;transition:all 0.2s;display:inline-flex;align-items:center;gap:10px;}
.btn-green:hover{transform:translate(-3px,-3px);box-shadow:9px 9px 0 var(--brown5);}

/* FOOTER */
footer{background:var(--brown5);color:var(--cream);padding:60px 2rem 28px;position:relative;overflow:hidden;}
footer::before{content:'üêøÔ∏è';position:absolute;font-size:12rem;opacity:0.04;bottom:-20px;right:40px;pointer-events:none;transform:scaleX(-1);}
.footer-grid{display:grid;grid-template-columns:1.5fr 1fr 1fr;gap:40px;max-width:1100px;margin:0 auto;}
.footer-brand{display:flex;align-items:center;gap:10px;margin-bottom:12px;}
.footer-logo-img{width:32px;height:32px;object-fit:cover;border-radius:50%;}
.footer-brand-name{font-family:'Fredoka One',cursive;font-size:1.4rem;}
.footer-desc{font-family:'Patrick Hand',cursive;color:rgba(253,246,236,0.6);font-size:0.95rem;line-height:1.7;}
.footer-heading{font-family:'Fredoka One',cursive;font-size:1.1rem;color:var(--warm);margin-bottom:12px;}
.footer-link{display:block;font-family:'Caveat',cursive;font-size:1.1rem;color:rgba(253,246,236,0.6);text-decoration:none;margin-bottom:6px;transition:color 0.2s;}
.footer-link:hover{color:var(--warm);}
.footer-hours-day{font-family:'Patrick Hand',cursive;color:rgba(253,246,236,0.6);font-size:0.9rem;}
.footer-hours-time{font-family:'Fredoka One',cursive;color:white;font-size:1rem;}
.footer-bottom{max-width:1100px;margin:40px auto 0;padding-top:20px;border-top:2px dashed rgba(253,246,236,0.2);text-align:center;font-family:'Caveat',cursive;font-size:1.1rem;color:rgba(253,246,236,0.5);}
.footer-crumb-trail{display:flex;justify-content:center;gap:8px;margin-bottom:24px;opacity:0.3;}
.footer-crumb{font-size:0.6rem;color:var(--warm);}

/* MENU PAGE */
#page-menu{position:relative;}
.menu-hero{background:var(--brown2);padding:120px 2rem 80px;text-align:center;position:relative;overflow:hidden;}
.menu-hero::before{content:'üå∞ üêøÔ∏è üå∞ üêøÔ∏è üå∞ üêøÔ∏è üå∞ üêøÔ∏è üå∞';position:absolute;top:20px;left:0;right:0;font-size:1.5rem;letter-spacing:12px;opacity:0.12;pointer-events:none;}
.menu-hero-eyebrow{font-family:'Caveat',cursive;font-size:1.4rem;color:var(--warm);margin-bottom:8px;transform:rotate(-1deg);display:block;}
.menu-hero-title{font-family:'Fredoka One',cursive;font-size:clamp(2.8rem,6vw,5rem);color:var(--cream);margin-bottom:8px;text-shadow:4px 4px 0 var(--brown4);}
.menu-hero-sub{font-family:'Patrick Hand',cursive;color:rgba(253,246,236,0.65);font-size:1.1rem;}
.menu-content{max-width:1100px;margin:0 auto;padding:40px 2rem 80px;}

/* CAROUSEL */
.carousel-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;}
.carousel-title-wrap{display:flex;align-items:center;gap:12px;}
.flame-box{width:40px;height:40px;background:var(--accent);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.1rem;border:2px solid var(--brown5);}
.carousel-title{font-family:'Fredoka One',cursive;font-size:1.8rem;color:var(--brown2);}
.carousel-arrows{display:flex;gap:8px;}
.arrow-btn{width:40px;height:40px;background:white;border-radius:50%;border:2.5px solid var(--brown4);box-shadow:3px 3px 0 var(--brown4);cursor:pointer;font-size:1.1rem;color:var(--brown2);transition:all 0.2s;display:flex;align-items:center;justify-content:center;}
.arrow-btn:hover{background:var(--brown4);color:white;transform:translate(-1px,-1px);}
.carousel-track{display:flex;gap:20px;overflow-x:auto;padding-bottom:16px;scroll-snap-type:x mandatory;scrollbar-width:none;}
.carousel-track::-webkit-scrollbar{display:none;}
.carousel-card{flex-shrink:0;width:260px;background:white;border-radius:20px;border:3px solid var(--brown4);box-shadow:6px 6px 0 var(--brown4);cursor:pointer;scroll-snap-align:start;transition:all 0.2s;position:relative;overflow:hidden;}
.carousel-card:hover:not(.item-sold-out){transform:translate(-3px,-3px);box-shadow:9px 9px 0 var(--brown4);}
.carousel-card.item-sold-out{cursor:default;}
.carousel-img-wrap{position:relative;height:170px;overflow:hidden;}
.carousel-img-wrap img{width:100%;height:100%;object-fit:cover;transition:transform 0.4s;}
.carousel-card:hover:not(.item-sold-out) .carousel-img-wrap img{transform:scale(1.08);}
.carousel-img-overlay{position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,0.5),transparent);}
.carousel-price{position:absolute;bottom:10px;right:10px;background:var(--accent);color:white;padding:4px 12px;border-radius:999px;font-family:'Fredoka One',cursive;font-size:1rem;border:2px solid rgba(255,255,255,0.3);}
.carousel-card-body{padding:16px;}
.carousel-card-name{font-family:'Fredoka One',cursive;font-size:1rem;color:var(--brown2);margin-bottom:5px;}
.carousel-card-desc{font-size:0.82rem;line-height:1.5;color:var(--brown5);display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;}

/* CATEGORY TABS */
.cat-tabs-wrap{position:sticky;top:70px;z-index:50;background:rgba(253,246,236,0.97);backdrop-filter:blur(10px);padding:12px 0;margin:24px -2rem;padding-left:2rem;padding-right:2rem;border-bottom:3px solid var(--brown4);}
.cat-tabs{display:flex;gap:8px;overflow-x:auto;scrollbar-width:none;}
.cat-tabs::-webkit-scrollbar{display:none;}
.cat-tab{flex-shrink:0;padding:8px 20px;border-radius:999px;border:2.5px solid var(--brown4);cursor:pointer;font-family:'Fredoka One',cursive;font-size:0.95rem;transition:all 0.2s;background:white;color:var(--brown2);box-shadow:3px 3px 0 var(--brown4);}
.cat-tab.active{background:var(--brown2);color:white;}
.cat-tab:hover:not(.active){transform:translate(-1px,-1px);box-shadow:4px 4px 0 var(--brown4);}

/* MENU SECTIONS */
.menu-section{margin-bottom:52px;}
.menu-section-title{display:flex;align-items:center;gap:10px;font-family:'Fredoka One',cursive;font-size:1.8rem;color:var(--brown2);margin-bottom:18px;}
.menu-items-grid{display:grid;grid-template-columns:1fr 1fr;gap:12px;}
.menu-item-card{background:white;border-radius:16px;padding:14px;display:flex;align-items:center;gap:12px;border:2.5px solid var(--brown4);box-shadow:4px 4px 0 var(--brown4);cursor:pointer;transition:all 0.2s;overflow:hidden;position:relative;}
.menu-item-card:hover:not(.item-sold-out){transform:translate(-2px,-2px);box-shadow:6px 6px 0 var(--brown4);}
.menu-item-card.item-sold-out{cursor:default;}
.menu-item-thumb{width:70px;height:70px;min-width:70px;border-radius:12px;overflow:hidden;background:var(--light);flex-shrink:0;border:2px solid var(--light);}
.menu-item-thumb img{width:100%;height:100%;object-fit:cover;transition:transform 0.3s;display:block;}
.menu-item-card:hover:not(.item-sold-out) .menu-item-thumb img{transform:scale(1.1);}
.menu-item-info{flex:1;min-width:0;overflow:hidden;}
.menu-item-name{font-family:'Fredoka One',cursive;font-size:0.95rem;color:var(--brown2);margin-bottom:4px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
.menu-item-desc{font-size:0.78rem;line-height:1.45;color:var(--brown5);display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden;}
.menu-item-right{display:flex;flex-direction:column;align-items:flex-end;gap:6px;flex-shrink:0;}
.menu-item-price{font-family:'Fredoka One',cursive;font-size:0.95rem;color:var(--brown2);}
.plus-btn{width:28px;height:28px;background:var(--accent);border-radius:50%;border:2px solid var(--brown5);color:white;font-size:1rem;cursor:pointer;display:flex;align-items:center;justify-content:center;opacity:0;transition:opacity 0.2s;box-shadow:2px 2px 0 var(--brown5);}
.menu-item-card:hover:not(.item-sold-out) .plus-btn{opacity:1;}
@media(hover:none){.plus-btn{opacity:1;}}
.sold-out-overlay{position:absolute;inset:0;border-radius:14px;background:rgba(200,200,200,0.8);display:flex;align-items:center;justify-content:center;z-index:2;}
.sold-out-label{font-family:'Fredoka One',cursive;font-size:0.9rem;color:#666;background:rgba(255,255,255,0.9);padding:6px 16px;border-radius:999px;border:2px solid #aaa;}
.carousel-sold-overlay{position:absolute;inset:0;border-radius:18px;background:rgba(200,200,200,0.75);display:flex;align-items:center;justify-content:center;z-index:3;}
.carousel-sold-label{font-family:'Fredoka One',cursive;font-size:0.95rem;color:#666;background:rgba(255,255,255,0.9);padding:8px 18px;border-radius:999px;border:2px solid #aaa;}

/* MODAL */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.65);backdrop-filter:blur(4px);z-index:200;display:none;align-items:flex-end;justify-content:center;}
.modal-backdrop.open{display:flex;}
@media(min-width:768px){.modal-backdrop{align-items:center;}}
.modal-panel{background:var(--cream);border-radius:24px 24px 0 0;width:100%;max-width:480px;max-height:90vh;overflow-y:auto;animation:slideUp 0.35s cubic-bezier(0.25,0.46,0.45,0.94);border-top:4px solid var(--brown4);border-left:4px solid var(--brown4);border-right:4px solid var(--brown4);}
@media(min-width:768px){.modal-panel{border-radius:24px;border:4px solid var(--brown4);box-shadow:10px 10px 0 var(--brown5);max-height:85vh;}}
@keyframes slideUp{from{transform:translateY(100%);opacity:0;}to{transform:translateY(0);opacity:1;}}
.modal-img{position:relative;height:190px;flex-shrink:0;}
.modal-img img{width:100%;height:100%;object-fit:cover;}
.modal-img-overlay{position:absolute;inset:0;background:linear-gradient(to top,rgba(0,0,0,0.65),transparent);}
.modal-close{position:absolute;top:12px;right:12px;width:34px;height:34px;background:white;border-radius:50%;border:2px solid var(--brown4);cursor:pointer;font-size:1rem;display:flex;align-items:center;justify-content:center;box-shadow:2px 2px 0 var(--brown5);}
.modal-item-name{position:absolute;bottom:12px;left:14px;font-family:'Fredoka One',cursive;font-size:1.4rem;color:white;text-shadow:2px 2px 4px rgba(0,0,0,0.5);}
.modal-body{padding:22px;}
.modal-price-row{display:flex;align-items:center;justify-content:space-between;margin-bottom:18px;}
.modal-price{font-family:'Fredoka One',cursive;font-size:2rem;color:var(--brown2);}
.qty-row{display:flex;align-items:center;gap:10px;background:white;border-radius:999px;padding:4px;box-shadow:0 2px 8px rgba(0,0,0,0.1);border:2px solid var(--brown4);}
.qty-btn{width:34px;height:34px;background:none;border:none;cursor:pointer;border-radius:50%;font-size:1.1rem;transition:background 0.2s;display:flex;align-items:center;justify-content:center;}
.qty-btn:hover{background:var(--light);}
.qty-num{font-family:'Fredoka One',cursive;font-size:1.2rem;width:26px;text-align:center;color:var(--brown2);}
.modal-label{font-family:'Fredoka One',cursive;color:var(--brown2);margin-bottom:7px;font-size:0.95rem;display:block;}
.modal-select{width:100%;background:white;border:2.5px solid var(--brown4);border-radius:12px;padding:10px 14px;font-family:'Patrick Hand',cursive;font-size:0.95rem;color:var(--brown5);outline:none;transition:border-color 0.2s;cursor:pointer;appearance:none;background-image:url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8' viewBox='0 0 12 8'%3E%3Cpath d='M1 1l5 5 5-5' stroke='%238B4513' stroke-width='2' fill='none' stroke-linecap='round'/%3E%3C/svg%3E");background-repeat:no-repeat;background-position:right 14px center;padding-right:36px;}
.modal-select:focus{border-color:var(--brown2);}
.modal-select option:disabled{color:#aaa;font-style:italic;}
.modal-form-group{margin-bottom:14px;}
.modal-textarea{width:100%;background:white;border:2.5px solid var(--brown4);border-radius:14px;padding:11px;font-family:'Patrick Hand',cursive;font-size:0.95rem;color:var(--brown5);resize:none;outline:none;transition:border-color 0.2s;}
.modal-textarea:focus{border-color:var(--brown2);}
.combo-selectors{background:rgba(139,69,19,0.06);border-radius:14px;padding:14px;border:2px dashed var(--brown4);margin-bottom:14px;}
.combo-selector-title{font-family:'Fredoka One',cursive;font-size:1rem;color:var(--brown2);margin-bottom:10px;}
.modal-add-btn{width:100%;background:var(--accent);color:white;border:3px solid var(--brown5);cursor:pointer;padding:14px;border-radius:14px;font-family:'Fredoka One',cursive;font-size:1rem;margin-top:14px;box-shadow:4px 4px 0 var(--brown5);transition:all 0.2s;}
.modal-add-btn:hover{transform:translate(-2px,-2px);box-shadow:6px 6px 0 var(--brown5);}
.modal-lock-btn{position:absolute;top:12px;left:12px;width:34px;height:34px;background:white;border-radius:50%;border:2px solid var(--brown4);cursor:pointer;font-size:1rem;display:flex;align-items:center;justify-content:center;transition:all 0.2s;z-index:10;box-shadow:2px 2px 0 var(--brown5);}
.modal-lock-btn:hover{transform:scale(1.1);}
.modal-lock-btn.locked{background:var(--brown5);}

/* TOPPINGS */
.toppings-grid{display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:6px;}
.topping-check-label{display:flex;align-items:center;gap:8px;background:white;border:2px solid var(--brown4);border-radius:10px;padding:8px 12px;cursor:pointer;font-family:'Patrick Hand',cursive;font-size:0.9rem;color:var(--brown5);transition:all 0.15s;position:relative;}
.topping-check-label.sold-out-topping{opacity:0.55;cursor:default;background:#f5f5f5;border-color:#ccc;}
.topping-check-label:has(input:checked):not(.sold-out-topping){background:var(--brown2);color:white;border-color:var(--brown5);}
.topping-check-label input{display:none;}
.topping-sold-badge{font-size:0.7rem;background:rgba(220,53,69,0.15);color:#dc3545;border:1px solid rgba(220,53,69,0.3);border-radius:999px;padding:1px 6px;margin-left:auto;}

.admin-86-link{display:inline-flex;align-items:center;gap:4px;margin-top:5px;background:none;border:none;font-family:'Caveat',cursive;font-size:0.95rem;color:var(--brown4);cursor:pointer;text-decoration:underline;padding:0;}
.admin-86-link:hover{color:var(--accent);}

/* MENU CLOSED OVERLAY */
#menu-closed-overlay{position:absolute;top:0;left:0;right:0;bottom:0;background:rgba(26,15,10,0.92);z-index:60;display:none;align-items:center;justify-content:center;flex-direction:column;backdrop-filter:blur(6px);min-height:100%;}
#menu-closed-overlay.open{display:flex;}
.closed-overlay-icon{font-size:5rem;margin-bottom:14px;animation:floatBob 2s ease-in-out infinite;}
.closed-overlay-title{font-family:'Fredoka One',cursive;font-size:clamp(2rem,6vw,3.5rem);color:var(--cream);margin-bottom:8px;text-align:center;text-shadow:4px 4px 0 var(--brown4);}
.closed-overlay-sub{font-family:'Patrick Hand',cursive;color:rgba(253,246,236,0.6);font-size:1.05rem;text-align:center;max-width:320px;line-height:1.6;}
.closed-overlay-time{margin-top:20px;background:rgba(201,122,58,0.2);border:2px solid rgba(201,122,58,0.4);border-radius:14px;padding:12px 24px;font-family:'Fredoka One',cursive;color:var(--warm);font-size:0.95rem;}
.overlay-admin-btn{margin-top:24px;background:rgba(253,246,236,0.1);border:2px solid rgba(253,246,236,0.2);color:rgba(253,246,236,0.5);padding:10px 22px;border-radius:999px;font-family:'Fredoka One',cursive;font-size:0.85rem;cursor:pointer;transition:all 0.25s;}
.overlay-admin-btn:hover{background:rgba(253,246,236,0.2);color:var(--cream);}

#menu-toggle-btn{position:fixed;bottom:28px;left:28px;z-index:110;width:52px;height:52px;border-radius:50%;border:3px solid var(--brown5);cursor:pointer;background:var(--brown2);color:var(--cream);font-size:1.3rem;box-shadow:4px 4px 0 var(--brown5);display:none;align-items:center;justify-content:center;transition:all 0.2s;}
#menu-toggle-btn:hover{background:var(--accent);transform:translate(-2px,-2px);box-shadow:6px 6px 0 var(--brown5);}

/* ADMIN MODAL */
#admin-modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,0.7);backdrop-filter:blur(5px);z-index:9000;display:none;align-items:center;justify-content:center;padding:16px;}
.admin-panel{background:var(--cream);border-radius:24px;width:100%;max-width:380px;padding:30px;border:4px solid var(--brown4);box-shadow:10px 10px 0 var(--brown5);animation:slideUp 0.3s ease;}
.admin-panel-icon{width:56px;height:56px;border-radius:50%;background:var(--brown2);display:flex;align-items:center;justify-content:center;font-size:1.5rem;margin:0 auto 16px;border:2px solid var(--brown4);}
.admin-panel-title{font-family:'Fredoka One',cursive;font-size:1.4rem;color:var(--brown2);text-align:center;margin-bottom:6px;}
.admin-panel-sub{font-family:'Patrick Hand',cursive;color:var(--brown5);font-size:0.9rem;text-align:center;margin-bottom:20px;line-height:1.5;}
.admin-pw-input{width:100%;background:white;border:2.5px solid var(--brown4);border-radius:12px;padding:12px 14px;font-family:'Nunito',sans-serif;font-size:1rem;color:var(--brown2);outline:none;transition:border-color 0.2s;letter-spacing:0.1em;margin-bottom:10px;}
.admin-pw-input:focus{border-color:var(--brown2);}
.admin-pw-input.error{border-color:#dc3545;animation:shake 0.3s ease;}
@keyframes shake{0%,100%{transform:translateX(0);}25%{transform:translateX(-6px);}75%{transform:translateX(6px);}}
.admin-error-msg{color:#dc3545;font-size:0.82rem;margin-bottom:8px;text-align:center;min-height:18px;font-family:'Caveat',cursive;font-size:1rem;}
.admin-submit-btn{width:100%;background:var(--brown2);color:white;border:3px solid var(--brown5);cursor:pointer;padding:13px;border-radius:12px;font-family:'Fredoka One',cursive;font-size:1rem;box-shadow:4px 4px 0 var(--brown5);margin-bottom:8px;transition:all 0.2s;}
.admin-submit-btn:hover{transform:translate(-2px,-2px);box-shadow:6px 6px 0 var(--brown5);}
.admin-cancel-btn{width:100%;background:transparent;color:var(--brown5);border:none;cursor:pointer;padding:10px;font-family:'Patrick Hand',cursive;font-size:0.95rem;transition:color 0.2s;}
.admin-cancel-btn:hover{color:var(--brown2);}

.option-toggle-row{display:flex;align-items:center;justify-content:space-between;padding:10px 14px;border-radius:12px;margin-bottom:8px;border:2px solid;}
.option-toggle-row.available{background:rgba(59,130,80,0.06);border-color:rgba(59,130,80,0.25);}
.option-toggle-row.eighty-six{background:rgba(220,53,69,0.08);border-color:rgba(220,53,69,0.3);}
.option-toggle-name{font-family:'Patrick Hand',cursive;font-size:1rem;color:var(--brown2);}
.option-toggle-btn{padding:5px 14px;border-radius:999px;font-family:'Fredoka One',cursive;font-size:0.82rem;cursor:pointer;border:2px solid var(--brown5);color:white;transition:all 0.15s;}
.option-toggle-btn.btn-86{background:#dc3545;}
.option-toggle-btn.btn-restore{background:var(--brown2);}
.option-toggle-btn:hover{opacity:0.85;transform:scale(0.97);}

/* CART BUBBLE */
#cart-bubble{position:fixed;bottom:28px;right:28px;z-index:100;background:var(--brown2);color:white;padding:13px 22px;border-radius:999px;border:3px solid var(--brown5);box-shadow:6px 6px 0 var(--brown5);display:none;align-items:center;gap:10px;cursor:pointer;transition:all 0.2s;animation:bubbleIn 0.35s ease;font-family:'Fredoka One',cursive;}
#cart-bubble:hover{transform:translate(-2px,-2px);box-shadow:8px 8px 0 var(--brown5);}
@keyframes bubbleIn{from{transform:translateY(40px);opacity:0;}to{transform:translateY(0);opacity:1;}}
.bubble-icon-wrap{position:relative;}
.bubble-badge{position:absolute;top:-8px;right:-8px;width:20px;height:20px;background:var(--accent);border-radius:50%;font-size:0.7rem;font-weight:700;border:2px solid var(--brown5);display:flex;align-items:center;justify-content:center;}
.bubble-divider{width:1px;height:22px;background:rgba(255,255,255,0.3);}
.bubble-total{font-size:1.1rem;}

/* ORDER PAGE */
.order-hero{background:var(--brown2);padding:120px 2rem 60px;text-align:center;position:relative;overflow:hidden;}
.order-hero::before{content:'üå∞ üêøÔ∏è üå∞ üêøÔ∏è üå∞';position:absolute;top:24px;left:0;right:0;font-size:1.5rem;letter-spacing:14px;opacity:0.1;pointer-events:none;}
.order-hero-title{font-family:'Fredoka One',cursive;font-size:clamp(2.5rem,5vw,4rem);color:var(--cream);margin-bottom:10px;text-shadow:4px 4px 0 var(--brown4);}
.order-hero-sub{font-family:'Patrick Hand',cursive;color:rgba(253,246,236,0.65);font-size:1rem;}
.order-content{max-width:780px;margin:0 auto;padding:40px 2rem 80px;}
.tab-switch{display:flex;gap:6px;background:white;border-radius:14px;padding:5px;border:3px solid var(--brown4);box-shadow:5px 5px 0 var(--brown4);margin-bottom:28px;}
.tab-btn{flex:1;padding:11px;border-radius:10px;border:none;cursor:pointer;font-family:'Fredoka One',cursive;font-size:1rem;transition:all 0.2s;background:none;color:var(--brown2);}
.tab-btn.active{background:var(--brown2);color:white;}
.tab-panel{display:none;}
.tab-panel.active{display:block;animation:fadeUp 0.3s ease;}
.order-section-card{background:white;border-radius:20px;padding:26px;border:3px solid var(--brown4);box-shadow:6px 6px 0 var(--brown4);margin-bottom:16px;}
.order-section-head{display:flex;align-items:center;gap:10px;font-family:'Fredoka One',cursive;font-size:1.2rem;color:var(--brown2);margin-bottom:18px;}
.cart-item-row{display:flex;align-items:flex-start;gap:12px;padding:12px;background:var(--light);border-radius:12px;margin-bottom:8px;border:2px solid var(--light);}
.cart-item-thumb{width:50px;height:50px;border-radius:10px;overflow:hidden;flex-shrink:0;border:2px solid var(--brown4);}
.cart-item-thumb img{width:100%;height:100%;object-fit:cover;}
.cart-item-info{flex:1;min-width:0;}
.cart-item-name{font-family:'Fredoka One',cursive;font-size:0.92rem;color:var(--brown2);}
.cart-item-note{font-family:'Patrick Hand',cursive;color:#999;font-size:0.76rem;line-height:1.4;white-space:pre-line;}
.cart-item-price{font-family:'Fredoka One',cursive;color:var(--brown2);font-size:0.88rem;margin-top:2px;}
.cart-controls{display:flex;align-items:center;gap:5px;flex-shrink:0;}
.cart-qty-btn{width:26px;height:26px;border-radius:50%;background:white;border:2px solid var(--brown4);cursor:pointer;font-size:1rem;display:flex;align-items:center;justify-content:center;transition:all 0.2s;}
.cart-qty-btn:hover{background:var(--accent);color:white;border-color:var(--accent);}
.cart-qty{width:20px;text-align:center;font-family:'Fredoka One',cursive;font-size:0.9rem;color:var(--brown2);}
.remove-btn{width:26px;height:26px;border-radius:50%;background:white;border:2px solid #dc3545;cursor:pointer;color:#dc3545;font-size:0.85rem;display:flex;align-items:center;justify-content:center;transition:all 0.2s;margin-left:2px;}
.remove-btn:hover{background:#dc3545;color:white;}
.order-total-row{display:flex;justify-content:space-between;align-items:center;padding-top:14px;border-top:2px dashed var(--brown4);margin-top:6px;}
.order-total-label{font-family:'Fredoka One',cursive;color:var(--brown2);}
.order-total-val{font-family:'Fredoka One',cursive;font-size:1.6rem;color:var(--brown2);}
.form-label{display:block;font-family:'Fredoka One',cursive;color:var(--brown2);margin-bottom:6px;font-size:0.92rem;}
.form-input{width:100%;background:var(--light);border:2.5px solid var(--brown4);border-radius:12px;padding:11px 14px;font-family:'Patrick Hand',cursive;font-size:0.95rem;color:var(--brown5);outline:none;transition:border-color 0.2s;}
.form-input:focus{border-color:var(--brown2);}
.form-select{width:100%;background:var(--light);border:2.5px solid var(--brown4);border-radius:12px;padding:11px 14px;font-family:'Patrick Hand',cursive;font-size:0.95rem;color:var(--brown5);outline:none;appearance:none;cursor:pointer;}
.form-group{margin-bottom:14px;}
.submit-btn{width:100%;background:var(--accent);color:white;border:3px solid var(--brown5);cursor:pointer;padding:16px;border-radius:14px;font-family:'Fredoka One',cursive;font-size:1rem;box-shadow:5px 5px 0 var(--brown5);transition:all 0.2s;display:flex;align-items:center;justify-content:center;gap:8px;}
.submit-btn:hover{transform:translate(-2px,-2px);box-shadow:7px 7px 0 var(--brown5);}
.submit-btn:disabled{opacity:0.6;cursor:not-allowed;transform:none;}
.empty-cart{text-align:center;padding:44px 20px;}
.empty-squirrel{font-size:4rem;margin-bottom:14px;animation:floatBob 2s ease-in-out infinite;}
.empty-title{font-family:'Fredoka One',cursive;font-size:1.5rem;color:var(--brown2);margin-bottom:8px;}
.empty-sub{font-family:'Patrick Hand',cursive;color:rgba(90,45,0,0.6);margin-bottom:22px;font-size:1.05rem;}

/* STAFF VIEW */
.queue-header{font-family:'Fredoka One',cursive;font-size:1.2rem;color:var(--brown2);display:flex;align-items:center;gap:8px;margin-bottom:14px;}
.queue-count{font-family:'Patrick Hand',cursive;font-size:0.9rem;color:#999;}
.order-cards-grid{display:grid;grid-template-columns:1fr 1fr;gap:14px;}
.order-card{background:white;border-radius:18px;padding:18px;border:3px solid var(--brown4);box-shadow:5px 5px 0 var(--brown4);}
.order-card.order-canceled{border-color:#dc3545;box-shadow:5px 5px 0 rgba(220,53,69,0.4);opacity:0.75;}
.order-card-header{display:flex;align-items:flex-start;justify-content:space-between;margin-bottom:12px;}
.order-card-name{font-family:'Fredoka One',cursive;font-size:1rem;color:var(--brown2);}
.order-card-time{font-family:'Patrick Hand',cursive;color:#aaa;font-size:0.8rem;}
.order-price-badge{background:rgba(139,58,0,0.1);color:var(--brown2);padding:4px 12px;border-radius:999px;font-family:'Fredoka One',cursive;font-size:0.82rem;border:1.5px solid var(--brown4);}
.order-item-row{display:flex;align-items:flex-start;gap:7px;font-size:0.83rem;margin-bottom:5px;}
.order-item-qty{width:20px;height:20px;background:var(--brown2);color:white;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:0.65rem;font-weight:700;flex-shrink:0;margin-top:1px;}
.order-item-name{font-family:'Patrick Hand',cursive;color:var(--brown5);font-size:0.9rem;}
.order-item-customizations{font-family:'Patrick Hand',cursive;color:#888;font-size:0.78rem;font-style:italic;line-height:1.4;}
.order-extra-note{background:var(--light);border-radius:10px;padding:8px 11px;font-family:'Patrick Hand',cursive;color:#999;font-size:0.82rem;font-style:italic;margin-bottom:12px;}
.mark-complete-btn{width:100%;background:var(--brown2);color:white;border:2px solid var(--brown5);cursor:pointer;padding:10px;border-radius:10px;font-family:'Fredoka One',cursive;font-size:0.88rem;box-shadow:3px 3px 0 var(--brown5);display:flex;align-items:center;justify-content:center;gap:5px;transition:all 0.2s;}
.mark-complete-btn:hover{transform:translate(-1px,-1px);box-shadow:4px 4px 0 var(--brown5);}
.cancel-order-btn{width:100%;background:transparent;color:#dc3545;border:2px solid rgba(220,53,69,0.4);cursor:pointer;padding:8px;border-radius:10px;font-family:'Fredoka One',cursive;font-size:0.82rem;transition:all 0.2s;margin-top:6px;display:flex;align-items:center;justify-content:center;gap:5px;}
.cancel-order-btn:hover{background:#dc3545;color:white;border-color:#dc3545;}
.completed-cards{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:6px;}
.completed-card{background:rgba(90,45,0,0.05);border-radius:14px;padding:14px;position:relative;border:2px dashed var(--brown4);}
.completed-check{position:absolute;top:10px;right:10px;color:var(--brown2);font-size:1.1rem;}
.completed-name{font-family:'Fredoka One',cursive;color:rgba(90,45,0,0.6);font-size:0.92rem;}
.completed-sub{font-family:'Patrick Hand',cursive;color:#aaa;font-size:0.78rem;}
.canceled-cards{display:grid;grid-template-columns:1fr 1fr;gap:10px;margin-top:6px;}
.canceled-card{background:rgba(220,53,69,0.05);border-radius:14px;padding:14px;position:relative;border:2px dashed rgba(220,53,69,0.4);}
.canceled-x{position:absolute;top:10px;right:10px;color:#dc3545;font-size:1.1rem;}
.canceled-name{font-family:'Fredoka One',cursive;color:rgba(220,53,69,0.7);font-size:0.92rem;}
.canceled-sub{font-family:'Patrick Hand',cursive;color:#aaa;font-size:0.78rem;}
.clear-completed-btn{width:100%;background:transparent;border:2px dashed rgba(220,53,69,0.4);color:#dc3545;cursor:pointer;padding:11px;border-radius:12px;font-family:'Fredoka One',cursive;font-size:0.9rem;transition:all 0.3s;margin-top:16px;display:flex;align-items:center;justify-content:center;gap:8px;}
.clear-completed-btn:hover{background:#dc3545;color:white;border-color:#dc3545;}
.empty-queue{text-align:center;padding:44px 20px;background:white;border-radius:18px;border:3px solid var(--brown4);box-shadow:5px 5px 0 var(--brown4);}
.customer-order-status{background:white;border-radius:18px;padding:18px;border:3px solid var(--brown4);box-shadow:5px 5px 0 var(--brown4);margin-bottom:16px;}
.status-item{display:flex;align-items:center;gap:10px;padding:10px;background:var(--light);border-radius:10px;margin-bottom:8px;}
.status-badge{padding:4px 12px;border-radius:999px;font-family:'Fredoka One',cursive;font-size:0.8rem;flex-shrink:0;}
.status-pending{background:rgba(201,122,58,0.2);color:var(--brown2);border:1.5px solid var(--brown4);}
.status-complete{background:rgba(59,130,80,0.15);color:#2d6b3e;border:1.5px solid rgba(59,130,80,0.4);}
.status-canceled{background:rgba(220,53,69,0.15);color:#dc3545;border:1.5px solid rgba(220,53,69,0.3);}
.status-name{font-family:'Fredoka One',cursive;font-size:0.9rem;color:var(--brown2);}
.status-sub{font-family:'Patrick Hand',cursive;color:#aaa;font-size:0.78rem;}

/* TOAST */
#success-toast{position:fixed;top:88px;left:50%;transform:translateX(-50%);z-index:300;background:var(--brown2);color:white;padding:15px 26px;border-radius:14px;border:3px solid var(--brown5);box-shadow:6px 6px 0 var(--brown5);display:none;align-items:center;gap:10px;min-width:280px;animation:toastIn 0.3s ease;font-family:'Fredoka One',cursive;}
@keyframes toastIn{from{transform:translateX(-50%) translateY(-16px);opacity:0;}to{transform:translateX(-50%) translateY(0);opacity:1;}}
.toast-check{font-size:1.3rem;}
.toast-title{font-size:0.95rem;}
.toast-sub{font-family:'Patrick Hand',cursive;font-size:0.82rem;opacity:0.8;}

/* RESPONSIVE */
@media(max-width:1024px){.why-grid{grid-template-columns:1fr;}.feature-cards{grid-template-columns:1fr 1fr;}.steps-grid{grid-template-columns:1fr 1fr;}.hours-grid{grid-template-columns:1fr;}.footer-grid{grid-template-columns:1fr 1fr;}.menu-items-grid{grid-template-columns:1fr;}.order-cards-grid{grid-template-columns:1fr;}.completed-cards{grid-template-columns:1fr;}.canceled-cards{grid-template-columns:1fr;}}
@media(max-width:640px){nav .nav-links,.nav-cta{display:none;}.hamburger{display:flex;}.hero-btns{flex-direction:column;}.feature-cards{grid-template-columns:1fr;}.steps-grid{grid-template-columns:1fr;}.special-card{flex-direction:column;text-align:center;padding:24px 20px;}.footer-grid{grid-template-columns:1fr;}.menu-items-grid{grid-template-columns:1fr;}.completed-cards{grid-template-columns:1fr;}.canceled-cards{grid-template-columns:1fr;}.menu-content{padding:28px 14px 80px;}.cat-tabs-wrap{margin:14px -14px;padding-left:14px;padding-right:14px;}#menu-toggle-btn{bottom:86px;}.toppings-grid{grid-template-columns:1fr;}.order-cards-grid{grid-template-columns:1fr;}}
</style>
</head>
<body>

<!-- ‚ïê‚ïê‚ïê FIREBASE SDK (module) ‚ïê‚ïê‚ïê -->
<script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-app.js";
  import {
    getFirestore, doc, setDoc, getDoc, onSnapshot,
    collection, addDoc, updateDoc, query, orderBy, deleteDoc
  } from "https://www.gstatic.com/firebasejs/10.12.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyCc4pJOojNG_cfYcC9R8LYvMV-XGiVONgk",
    authDomain: "crumb-cafe.firebaseapp.com",
    projectId: "crumb-cafe",
    storageBucket: "crumb-cafe.firebasestorage.app",
    messagingSenderId: "635163863072",
    appId: "1:635163863072:web:38393e4f5b91b4ebe83445",
    measurementId: "G-PNJEZ5WEQC"
  };

  const app = initializeApp(firebaseConfig);
  const db  = getFirestore(app);

  // Expose to global scope so the main script can use them
  window._db         = db;
  window._fsDoc      = doc;
  window._fsSet      = setDoc;
  window._fsGet      = getDoc;
  window._fsUpdate   = updateDoc;
  window._fsOnSnap   = onSnapshot;
  window._fsColl     = collection;
  window._fsAdd      = addDoc;
  window._fsQuery    = query;
  window._fsOrderBy  = orderBy;
  window._fsDelete   = deleteDoc;

  // Signal that Firebase is ready
  window._firebaseReady = true;
  window.dispatchEvent(new Event('firebaseReady'));
</script>

<div id="loading-screen">
  <span class="load-sq">üêøÔ∏è</span>
  <div class="loading-text">CRUMB CAF√â</div>
  <div class="loading-sub">gathering crumbs...</div>
  <div class="crumb-trail-load">
    <div class="crumb-dot"></div><div class="crumb-dot"></div><div class="crumb-dot"></div>
    <div class="crumb-dot"></div><div class="crumb-dot"></div>
  </div>
  <div class="progress-bar-outer"><div class="progress-bar-inner" id="prog-bar"></div></div>
</div>

<nav id="navbar">
  <a href="#" class="nav-logo" onclick="showPage('home');return false;">
    <img class="squirrel-logo-img" src="https://www.shutterstock.com/image-vector/cute-cartoon-squirrel-holding-acorn-600nw-2723344631.jpg" onerror="this.style.display='none';this.nextElementSibling.style.display='inline';" alt="Crumb Caf√© Squirrel"/>
    <span style="display:none;font-size:2rem;">üêøÔ∏è</span>
    <span class="nav-logo-text">Crumb Caf√©</span>
  </a>
  <div class="nav-links">
    <a href="#" class="nav-link active" id="nav-home" onclick="showPage('home');return false;">Home</a>
    <a href="#" class="nav-link" id="nav-menu" onclick="showPage('menu');return false;">Menu</a>
    <a href="#" class="nav-link" id="nav-order" onclick="showPage('order');return false;">Order</a>
  </div>
  <a href="#" class="nav-cta" onclick="showPage('order');return false;">Order Now üõí</a>
  <div class="hamburger" id="hamburger" onclick="toggleMobile()">
    <span></span><span></span><span></span>
  </div>
</nav>
<div class="mobile-menu" id="mobile-menu">
  <a href="#" class="mobile-link active" id="mob-home" onclick="showPage('home');toggleMobile();return false;">üè† Home</a>
  <a href="#" class="mobile-link" id="mob-menu" onclick="showPage('menu');toggleMobile();return false;">üçî Menu</a>
  <a href="#" class="mobile-link" id="mob-order" onclick="showPage('order');toggleMobile();return false;">üì¶ Order</a>
  <a href="#" class="mobile-cta" onclick="showPage('order');toggleMobile();return false;">Order Now üõí</a>
</div>

<!-- HOME PAGE -->
<div class="page active" id="page-home">
  <section class="hero">
    <div class="hero-doodles">
      <div class="doodle-acorn-1">üå∞</div>
      <div class="doodle-acorn-2">üå∞</div>
      <div class="doodle-acorn-3">üçÇ</div>
    </div>
    <div class="hero-squirrel-art">üêøÔ∏è</div>
    <div class="hero-content">
      <div class="hero-text-side">
        <div class="hero-badge">üêøÔ∏è Student-run since forever</div>
        <h1 class="hero-title">Late Nights,<br><span class="accent">Warm Bites!</span></h1>
        <p class="hero-desc">Your cozy campus corner for something good. Open late, made with love, powered by your fellow students at Swarthmore College. üß°</p>
        <div class="hero-btns">
          <a href="#" class="btn-primary" onclick="showPage('menu');return false;">Browse Menu üçî</a>
          <a href="#" class="btn-secondary" onclick="showPage('order');return false;">Place an Order üì¶</a>
        </div>
        <div class="hero-stats">
          <div class="stat-card"><div class="stat-num">7:45PM</div><div class="stat-label">Opens Nightly</div></div>
          <div class="stat-card"><div class="stat-num">100%</div><div class="stat-label">Student Run</div></div>
          <div class="stat-card"><div class="stat-num">‚àû</div><div class="stat-label">Cozy Vibes</div></div>
        </div>
      </div>
    </div>
    <div class="hero-crumb-trail">
      <div class="trail-dot"></div><div class="trail-dot"></div><div class="trail-dot"></div>
      <div class="trail-dot"></div><div class="trail-dot"></div><div class="trail-dot"></div>
      <div class="trail-dot"></div>
    </div>
  </section>

  <div class="wave-div" style="background:var(--brown2);"><svg viewBox="0 0 1440 60" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0,60 C180,0 360,60 540,30 C720,0 900,60 1080,30 C1260,0 1380,40 1440,20 L1440,60 Z" fill="#fdf6ec"/></svg></div>

  <section class="why-section">
    <div class="why-acorn-scatter wa1">üå∞</div><div class="why-acorn-scatter wa2">üêøÔ∏è</div><div class="why-acorn-scatter wa3">üçÇ</div><div class="why-acorn-scatter wa4">üå∞</div>
    <div class="section-inner">
      <div class="why-grid">
        <div>
          <span class="eyebrow">Why Crumb?</span>
          <h2 class="section-title">More Than Just a Caf√© ‚Äî<br><span class="accent">It's Community!</span></h2>
          <p class="section-body">Crumb Caf√© is Swarthmore College's beloved late night destination, proudly student run since its founding. We're not just serving food and snacks ‚Äî we're creating opportunities for students to earn income, build skills, and be part of something special on campus.</p>
          <p class="section-body">Whether you're cramming for finals, catching up with friends, or just need a warm spot to think, Crumb is your place. Every purchase supports student employment and keeps this unique campus tradition alive. üß°</p>
        </div>
        <div class="why-squirrel-wrap"><div class="why-squirrel-ring"></div><div class="squirrel-big-anim">üêøÔ∏è</div></div>
      </div>
      <div class="feature-cards">
        <div class="feature-card"><div class="feature-icon">üíö</div><div class="feature-title">Student Run</div><div class="feature-desc">Every latte, every late night snack made by your fellow students who work long hours to make you happy.</div></div>
        <div class="feature-card"><div class="feature-icon">üåô</div><div class="feature-title">Open Late</div><div class="feature-desc">When the library closes and the cravings hit, we're here. Because good ideas (and hunger) don't follow a 9 to 5.</div></div>
        <div class="feature-card"><div class="feature-icon">üè†</div><div class="feature-title">Campus Home</div><div class="feature-desc">More than a caf√© ‚Äî it's where study breaks become friendships and late nights become memories.</div></div>
        <div class="feature-card"><div class="feature-icon">üêøÔ∏è</div><div class="feature-title">Made with Love</div><div class="feature-desc">Every crumb counts. We put care into everything we make, because that's what community tastes like.</div></div>
      </div>
    </div>
  </section>

  <div class="wave-div" style="background:var(--cream);"><svg viewBox="0 0 1440 60" preserveAspectRatio="none" xmlns="http://www.w3.org/2000/svg"><path d="M0,30 C200,60 400,0 600,30 C800,60 1000,0 1200,30 C1350,50 1410,20 1440,30 L1440,60 L0,60 Z" fill="#5a2d00"/></svg></div>

  <section class="special-section">
    <div class="special-card">
      <div class="spinning-badge"><div class="spinning-ring"></div><div class="badge-star">‚ú¶</div><div class="badge-text-top">TODAY'S</div><div class="badge-text-main">Special</div></div>
      <div class="special-info">
        <h3 class="special-name">Entr√©e Combo ‚Äî Any Entr√©e + Any Drink</h3>
        <p class="special-desc">Mix and match your favorite entr√©e with any drink on the menu for one low price! üçî‚òï</p>
        <div class="special-pricing"><span class="price-main">$7.00</span><span class="price-badge">Combo Deal!</span></div>
      </div>
      <button class="special-btn" onclick="showPage('menu')">Order Now! ‚Üí</button>
    </div>
  </section>

  <div class="wave-div" style="background:var(--brown2);"><svg viewBox="0 0 1440 60" preserveAspectRatio="none"><path d="M0,20 C120,60 240,10 360,40 C480,60 600,20 720,40 C840,60 960,20 1080,40 C1200,60 1350,15 1440,30 L1440,60 L0,60 Z" fill="#8B4513"/></svg></div>

  <section class="hours-section">
    <div class="section-inner">
      <h2 class="hours-title">üïò When to Find Us</h2>
      <div class="hours-grid">
        <div class="hours-card">
          <div class="hours-card-title">Operating Hours</div>
          <div class="hours-card-sub">Monday to Sunday üóìÔ∏è</div>
          <div class="time-row"><span class="time-label">Opening Time</span><span class="time-val">7:45 PM</span></div>
          <div class="time-row"><span class="time-label">Closing Time</span><span class="time-val">11:45 PM</span></div>
          <div class="hours-note"><span style="flex-shrink:0;margin-top:2px;">‚ö†Ô∏è</span><p class="note-text">Hours may vary due to staffing, academic events, or special circumstances. Check our menu page for real-time updates!</p></div>
        </div>
        <div class="contact-cards">
          <a href="mailto:crumb-gm@swarthmore.edu" class="contact-card"><div class="contact-icon-box">‚òï</div><div><div class="contact-role">General Manager</div><div class="contact-email">crumb-gm@swarthmore.edu</div></div><span class="contact-arrow">‚Üí</span></a>
          <a href="mailto:crumb-director@swarthmore.edu" class="contact-card"><div class="contact-icon-box">‚úâÔ∏è</div><div><div class="contact-role">Student Director</div><div class="contact-email">crumb-director@swarthmore.edu</div></div><span class="contact-arrow">‚Üí</span></a>
          <a href="mailto:crumb-feedback@swarthmore.edu" class="contact-card"><div class="contact-icon-box">üí¨</div><div><div class="contact-role">Feedback & Concerns</div><div class="contact-email">crumb-feedback@swarthmore.edu</div></div><span class="contact-arrow">‚Üí</span></a>
        </div>
      </div>
    </div>
  </section>

  <div class="wave-div" style="background:var(--brown4);"><svg viewBox="0 0 1440 60" preserveAspectRatio="none"><path d="M0,40 Q180,0 360,40 Q540,80 720,40 Q900,0 1080,40 Q1260,80 1440,40 L1440,60 L0,60 Z" fill="#fdf6ec"/></svg></div>

  <section class="quote-section">
    <div class="quote-squirrel-bg">üêøÔ∏è</div>
    <div style="max-width:750px;margin:0 auto;position:relative;">
      <blockquote class="quote-text">Every crumb<br><span class="accent">tells a story.</span></blockquote>
      <div class="quote-accent-line"><div class="quote-line"></div><div class="quote-acorn">üå∞</div><div class="quote-acorn" style="animation-delay:0.5s;">üêøÔ∏è</div><div class="quote-acorn" style="animation-delay:1s;">üå∞</div><div class="quote-line"></div></div>
    </div>
  </section>

  <div class="wave-div" style="background:var(--cream);"><svg viewBox="0 0 1440 60" preserveAspectRatio="none"><path d="M0,30 C180,0 360,60 540,30 C720,0 900,60 1080,30 C1260,0 1380,50 1440,30 L1440,60 L0,60 Z" fill="#f5e6d3"/></svg></div>

  <section class="how-section">
    <div class="how-header">
      <span class="eyebrow">Simple & Easy</span>
      <h2 class="section-title" style="margin-bottom:0;">How to Order üõí</h2>
      <p class="how-sub">Getting your late night cravings satisfied is easier than acing your finals ‚ú®</p>
    </div>
    <div class="section-inner">
      <div class="steps-grid">
        <div class="step-card"><div style="position:relative;display:inline-block;margin-bottom:16px;"><div class="step-icon-box">üîç</div><div class="step-num">01</div></div><div class="step-title">Browse the Menu</div><div class="step-desc">Explore drinks, appetizers, entr√©es, combos, and desserts online.</div></div>
        <div class="step-card"><div style="position:relative;display:inline-block;margin-bottom:16px;"><div class="step-icon-box">‚öôÔ∏è</div><div class="step-num">02</div></div><div class="step-title">Customize</div><div class="step-desc">Add special instructions ‚Äî extra cheese, oat milk, no onions!</div></div>
        <div class="step-card"><div style="position:relative;display:inline-block;margin-bottom:16px;"><div class="step-icon-box">üì§</div><div class="step-num">03</div></div><div class="step-title">Submit Order</div><div class="step-desc">Send your order through our simple page. No account needed!</div></div>
        <div class="step-card"><div style="position:relative;display:inline-block;margin-bottom:16px;"><div class="step-icon-box">üìç</div><div class="step-num">04</div></div><div class="step-title">Head to Crumb</div><div class="step-desc">Make your way to Crumb Caf√© and pay in person when you arrive.</div></div>
        <div class="step-card"><div style="position:relative;display:inline-block;margin-bottom:16px;"><div class="step-icon-box">üì¶</div><div class="step-num">05</div></div><div class="step-title">Pick Up & Enjoy!</div><div class="step-desc">Grab your order from the counter and enjoy your late night treat!</div></div>
      </div>
      <div class="how-cta"><button class="btn-green" onclick="showPage('menu')">Start Your Order üêøÔ∏è</button></div>
    </div>
  </section>

  <footer>
    <div class="footer-crumb-trail"><span class="footer-crumb">‚Ä¢</span><span class="footer-crumb">‚Ä¢</span><span class="footer-crumb">üå∞</span><span class="footer-crumb">‚Ä¢</span><span class="footer-crumb">‚Ä¢</span><span class="footer-crumb">üêøÔ∏è</span><span class="footer-crumb">‚Ä¢</span><span class="footer-crumb">‚Ä¢</span><span class="footer-crumb">üå∞</span><span class="footer-crumb">‚Ä¢</span><span class="footer-crumb">‚Ä¢</span></div>
    <div class="footer-grid">
      <div><div class="footer-brand"><img class="footer-logo-img" src="https://www.shutterstock.com/image-vector/cute-cartoon-squirrel-holding-acorn-600nw-2723344631.jpg" onerror="this.style.display='none';this.nextElementSibling.style.display='inline';" alt="Crumb Squirrel"/><span style="display:none;">üêøÔ∏è</span><span class="footer-brand-name">Crumb Caf√©</span></div><p class="footer-desc">Your cozy late night spot at Swarthmore College. Student-run, community loved. üß°</p></div>
      <div><div class="footer-heading">Quick Links</div><a href="#" class="footer-link" onclick="showPage('home');return false;">üè† Home</a><a href="#" class="footer-link" onclick="showPage('menu');return false;">üçî Menu</a><a href="#" class="footer-link" onclick="showPage('order');return false;">üì¶ Order</a></div>
      <div><div class="footer-heading">Hours</div><div class="footer-hours-day">Monday ‚Äì Sunday</div><div class="footer-hours-time">7:45 PM ‚Äì 11:45 PM</div></div>
    </div>
    <div class="footer-bottom">¬© 2026 Crumb Caf√© at Swarthmore College. Made with üêøÔ∏è by students.</div>
  </footer>
</div>

<!-- MENU PAGE -->
<div class="page" id="page-menu">
  <div id="menu-closed-overlay">
    <div class="closed-overlay-icon">üîí</div>
    <h2 class="closed-overlay-title">We're Closed!</h2>
    <p class="closed-overlay-sub">Crumb Caf√© is not taking orders right now. Check back during our operating hours!</p>
    <div class="closed-overlay-time">Monday ‚Äì Sunday ¬∑ 7:45 PM ‚Äì 11:45 PM</div>
    <button class="overlay-admin-btn" onclick="handleOpenMenu()">üîì Staff: Open Menu</button>
  </div>
  <div class="menu-hero">
    <div class="menu-hero-eyebrow">What We're Serving Tonight ‚ú®</div>
    <h1 class="menu-hero-title">Our Menu üçî</h1>
    <p class="menu-hero-sub">From cozy drinks to satisfying bites ‚Äî find your late night fave!</p>
  </div>
  <div class="menu-content">
    <div style="margin-bottom:36px;">
      <div class="carousel-header">
        <div class="carousel-title-wrap"><div class="flame-box">üî•</div><h2 class="carousel-title">Hot Right Now</h2></div>
        <div class="carousel-arrows"><button class="arrow-btn" onclick="scrollCarousel(-1)">‚Äπ</button><button class="arrow-btn" onclick="scrollCarousel(1)">‚Ä∫</button></div>
      </div>
      <div class="carousel-track" id="carousel-track"></div>
    </div>
    <div class="cat-tabs-wrap"><div class="cat-tabs" id="cat-tabs"></div></div>
    <div id="menu-sections"></div>
  </div>
  <footer>
    <div class="footer-grid">
      <div><div class="footer-brand"><img class="footer-logo-img" src="https://www.shutterstock.com/image-vector/cute-cartoon-squirrel-holding-acorn-600nw-2723344631.jpg" onerror="this.style.display='none'" alt=""/><span class="footer-brand-name">Crumb Caf√©</span></div><p class="footer-desc">Your cozy late night spot at Swarthmore College.</p></div>
      <div><div class="footer-heading">Quick Links</div><a href="#" class="footer-link" onclick="showPage('home');return false;">Home</a><a href="#" class="footer-link" onclick="showPage('menu');return false;">Menu</a><a href="#" class="footer-link" onclick="showPage('order');return false;">Order</a></div>
      <div><div class="footer-heading">Hours</div><div class="footer-hours-day">Monday ‚Äì Sunday</div><div class="footer-hours-time">7:45 PM ‚Äì 11:45 PM</div></div>
    </div>
    <div class="footer-bottom">¬© 2026 Crumb Caf√© at Swarthmore College. Made with üêøÔ∏è by students.</div>
  </footer>
</div>

<!-- ORDER PAGE -->
<div class="page" id="page-order">
  <div class="order-hero">
    <h1 class="order-hero-title">Order & Queue üõí</h1>
    <p class="order-hero-sub">Place your order and track the queue!</p>
  </div>
  <div class="order-content">
    <div class="tab-switch">
      <button class="tab-btn active" id="tab-place" onclick="switchTab('place')">üçî Place Order</button>
      <button class="tab-btn" id="tab-staff" onclick="switchTab('staff')">üë®‚Äçüç≥ Staff View</button>
    </div>
    <div class="tab-panel active" id="panel-place"><div id="place-order-content"></div></div>
    <div class="tab-panel" id="panel-staff"><div id="staff-content"></div></div>
  </div>
  <footer>
    <div class="footer-grid">
      <div><div class="footer-brand"><img class="footer-logo-img" src="https://www.shutterstock.com/image-vector/cute-cartoon-squirrel-holding-acorn-600nw-2723344631.jpg" onerror="this.style.display='none'" alt=""/><span class="footer-brand-name">Crumb Caf√©</span></div><p class="footer-desc">Student-run, community loved.</p></div>
      <div><div class="footer-heading">Quick Links</div><a href="#" class="footer-link" onclick="showPage('home');return false;">Home</a><a href="#" class="footer-link" onclick="showPage('menu');return false;">Menu</a><a href="#" class="footer-link" onclick="showPage('order');return false;">Order</a></div>
      <div><div class="footer-heading">Hours</div><div class="footer-hours-day">Monday ‚Äì Sunday</div><div class="footer-hours-time">7:45 PM ‚Äì 11:45 PM</div></div>
    </div>
    <div class="footer-bottom">¬© 2026 Crumb Caf√©. Made with üêøÔ∏è</div>
  </footer>
</div>

<!-- ITEM MODAL -->
<div class="modal-backdrop" id="item-modal" onclick="handleModalBackdrop(event)">
  <div class="modal-panel">
    <div class="modal-img">
      <img id="modal-img" src="" alt=""/>
      <div class="modal-img-overlay"></div>
      <button class="modal-lock-btn" id="modal-lock-btn" onclick="handleItemLock()" title="Admin: Lock/Unlock item">üîì</button>
      <button class="modal-close" onclick="closeModal()">‚úï</button>
      <div id="modal-item-name" class="modal-item-name"></div>
    </div>
    <div class="modal-body" id="modal-body-content"></div>
  </div>
</div>

<button id="menu-toggle-btn" title="Admin: Close Menu" onclick="handleCloseMenu()">üîí</button>

<div id="cart-bubble" onclick="showPage('order')">
  <div class="bubble-icon-wrap">üõí<span class="bubble-badge" id="bubble-count">0</span></div>
  <div class="bubble-divider"></div>
  <span class="bubble-total" id="bubble-total">$0.00</span>
</div>

<div id="success-toast">
  <span class="toast-check">‚úì</span>
  <div><div class="toast-title">Order submitted! üéâ</div><div class="toast-sub" id="toast-sub-text"></div></div>
</div>

<!-- ADMIN MODAL -->
<div id="admin-modal-backdrop" onclick="handleAdminBackdrop(event)">
  <div class="admin-panel" id="admin-panel-content">
    <div class="admin-panel-icon">üîê</div>
    <div class="admin-panel-title">Admin Access</div>
    <div class="admin-panel-sub">Enter the admin password to continue.</div>
    <input class="admin-pw-input" type="password" id="admin-pw-input" placeholder="Enter password..." onkeydown="if(event.key==='Enter')submitAdminPw()"/>
    <div class="admin-error-msg" id="admin-error"></div>
    <button class="admin-submit-btn" onclick="submitAdminPw()">Confirm ‚úì</button>
    <button class="admin-cancel-btn" onclick="closeAdminModal()">Cancel</button>
  </div>
</div>

<script>
/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   CONFIG
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const ADMIN_PASSWORD = 'password';

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   MENU DATA
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
const MENU = {
  drinks: [
    { id:'dr1', name:'Matcha Latte', price:2.00, img:'https://images.unsplash.com/photo-1536256263959-770b48d82b0a?w=400&q=80', desc:'Smooth ceremonial-grade matcha whisked with steamed milk ‚Äî earthy, creamy, and oh-so-cozy.', customizations:[{type:'select',label:'Temperature',key:'temp',options:['Hot','Iced']},{type:'select',label:'Milk',key:'milk',options:['Whole Milk','Oat Milk']}] },
    { id:'dr2', name:'Chai Latte', price:2.00, img:'https://images.unsplash.com/photo-1571934811356-5cc061b6821f?w=400&q=80', desc:'Spiced chai concentrate blended with steamed milk for a warm, aromatic hug in a cup.', customizations:[{type:'select',label:'Temperature',key:'temp',options:['Hot','Iced']},{type:'select',label:'Milk',key:'milk',options:['Whole Milk','Oat Milk']}] },
    { id:'dr3', name:'Hot Chocolate', price:2.00, img:'https://images.unsplash.com/photo-1517578239113-b03992dcdd25?w=400&q=80', desc:'Rich cocoa mixed with steamed milk and topped with fluffy whipped cream. Pure comfort.', customizations:[{type:'select',label:'Milk',key:'milk',options:['Whole Milk','Oat Milk']}] },
    { id:'dr4', name:'Italian Soda', price:3.00, img:'https://images.unsplash.com/photo-1497534446932-c925b458314e?w=400&q=80', desc:'Bubbly sparkling water mixed with your choice of sweet Italian syrup. Refreshing and fun!', customizations:[{type:'select',label:'Flavor',key:'flavor',options:['Mango','Raspberry','Strawberry','Vanilla','Mint','Amaretto','Ginger','Blueberry','Caramel']}] },
    { id:'dr5', name:'Milk Shake', price:5.00, img:'https://images.unsplash.com/photo-1568901346375-23c9450c58cd?w=400&q=80', desc:'Thick, creamy milkshakes blended to perfection. Only made with whole milk for the best flavor.', customizations:[{type:'select',label:'Flavor',key:'flavor',options:['Oreo','Chocolate','Vanilla','Strawberry',"M&M",'Chocolate Chip','Matcha','Chai']}] },
    { id:'dr6', name:'Smoothie', price:5.00, img:'https://images.unsplash.com/photo-1505252585461-04db1eb84625?w=400&q=80', desc:'Blended fruit smoothies made fresh to order. Healthy, delicious, and totally customizable!', customizations:[{type:'select',label:'Flavor',key:'flavor',options:['Tropical','Berry','Green','Strawberry Banana']},{type:'select',label:'Milk',key:'milk',options:['Whole Milk','Oat Milk']}] },
    { id:'dr7', name:'Iced or Hot Tea', price:2.00, img:'https://images.unsplash.com/photo-1556679343-c7306c1976bc?w=400&q=80', desc:'Classic loose-leaf teas served your way. Perfectly brewed for a calm, cozy moment.', customizations:[{type:'select',label:'Tea Type',key:'teaType',options:['Green Tea','Rooibos','Hibiscus','London Fog']},{type:'select',label:'Temperature',key:'temp',options:['Hot','Iced']}] },
  ],
  appetizers: [
    { id:'ap1', name:'Chips & Guac', price:4.00, img:'https://images.unsplash.com/photo-1576021182211-9ea8dced3690?w=400&q=80', desc:'Crispy tortilla chips served with fresh, chunky house-made guacamole. Simply the best.', customizations:[{type:'select',label:'Add Sour Cream?',key:'extra',options:['No Sour Cream','Add Sour Cream']}] },
    { id:'ap2', name:'Chips & Salsa', price:4.00, img:'https://images.unsplash.com/photo-1513456852971-30c0b8199d4d?w=400&q=80', desc:'Crunchy tortilla chips paired with vibrant, zesty salsa. The perfect late-night munch.', customizations:[{type:'select',label:'Add Sour Cream or Guac?',key:'extra',options:['Plain','Add Sour Cream','Add Guac']}] },
    { id:'ap3', name:'Loaded Quesadilla', price:5.00, img:'https://images.unsplash.com/photo-1565299585323-38d6b0865b47?w=400&q=80', desc:'A toasty tortilla packed with melted cheese, seasoned chicken, peppers, and onions. Loaded!', customizations:[{type:'select',label:'Add Sour Cream or Guac?',key:'extra',options:['Plain','Add Sour Cream','Add Guac']}] },
    { id:'ap4', name:'Simple Quesadilla', price:4.00, img:'https://images.unsplash.com/photo-1618160702438-9b02ab6515c9?w=400&q=80', desc:'Just good melted cheese in a crispy golden tortilla. Sometimes simple is perfect.', customizations:[{type:'select',label:'Add Sour Cream or Guac?',key:'extra',options:['Plain','Add Sour Cream','Add Guac']}] },
    { id:'ap5', name:'5 Wings', price:5.00, img:'https://images.unsplash.com/photo-1527477396000-e27163b481c2?w=400&q=80', desc:'Five crispy, golden wings cooked to perfection. Choose your flavor ‚Äî or keep it plain!', customizations:[{type:'select',label:'Wing Flavor',key:'wingFlavor',options:['Plain','Buffalo','Barbecue']}] },
    { id:'ap6', name:'Loaded Nachos', price:5.00, img:'https://images.unsplash.com/photo-1573682127510-9e8a0c8d18d7?w=400&q=80', desc:'A mountain of tortilla chips smothered in cheese, jalape√±os, beans, and all the toppings.', customizations:[{type:'select',label:'Add Sour Cream or Guac?',key:'extra',options:['Plain','Add Sour Cream','Add Guac']}] },
    { id:'ap7', name:'Simple Nachos', price:5.00, img:'https://images.unsplash.com/photo-1572695157366-5e585ab2b69f?w=400&q=80', desc:'Classic tortilla chips with warm melted cheese. Sometimes you just want the basics.', customizations:[{type:'select',label:'Add Sour Cream or Guac?',key:'extra',options:['Plain','Add Sour Cream','Add Guac']}] },
  ],
  entrees: [
    { id:'en1', name:"Mia's Chicken Sandwich", price:5.00, img:'https://images.unsplash.com/photo-1606755962773-d324e0a13086?w=400&q=80', desc:"Crumb's fan-favorite! Crispy chicken breast with lettuce, tomato, and our secret sauce on a toasted bun.", customizations:[] },
    { id:'en2', name:'Caprese Sandwich', price:5.00, img:'https://images.unsplash.com/photo-1509722747041-616f39b57569?w=400&q=80', desc:'Fresh mozzarella, ripe tomatoes, and fragrant basil with balsamic glaze on toasted ciabatta.', customizations:[] },
    { id:'en3', name:'Hot Dog', price:2.00, img:'https://images.unsplash.com/photo-1612392166886-ee8475b03af2?w=400&q=80', desc:'A classic all-beef hot dog in a soft, toasted bun. Top it how you like it!', customizations:[] },
    { id:'en4', name:'Grilled Cheese', price:5.00, img:'https://images.unsplash.com/photo-1528736235302-52922df5c122?w=400&q=80', desc:'Buttery sourdough bread with gooey melted cheddar and american cheese. Pure comfort food.', customizations:[] },
    { id:'en5', name:'Avocado Toast', price:4.00, img:'https://images.unsplash.com/photo-1588137378633-dea1336ce1e2?w=400&q=80', desc:'Toasted sourdough topped with smashed avocado, red pepper flakes, and a squeeze of lemon.', customizations:[] },
    { id:'en6', name:'Avocado Goato', price:4.00, img:'https://images.unsplash.com/photo-1594007654729-407eedc4be65?w=400&q=80', desc:'Avocado toast elevated with crumbled goat cheese, cherry tomatoes, and fresh herbs.', customizations:[] },
  ],
  combos: [
    { id:'co1', name:'Entr√©e Combo', price:7.00, img:'https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=400&q=80', desc:'Pick any $5 entr√©e paired with any $2 drink. Mix, match, and munch! Best deal on the menu.', customizations:[{type:'combo-entree',label:'Choose Your Entr√©e + Drink'}] },
    { id:'co2', name:'Appetizer Combo', price:7.00, img:'https://images.unsplash.com/photo-1604382354936-07c5d9983bd3?w=400&q=80', desc:'Pick any $5 appetizer paired with any $2 drink. The ultimate snack attack combo!', customizations:[{type:'combo-appetizer',label:'Choose Your Appetizer + Drink'}] },
  ],
  desserts: [
    { id:'ds1', name:'Ice Cream', price:3.00, img:'https://images.unsplash.com/photo-1497034825429-c343d7c6a68f?w=400&q=80', desc:'A scoop of creamy, dreamy ice cream in your favorite classic flavor. Always a great idea.', customizations:[{type:'select',label:'Flavor',key:'flavor',options:['Strawberry','Chocolate','Vanilla']}] },
    { id:'ds2', name:'Sundae', price:3.00, img:'https://images.unsplash.com/photo-1563805042-7684c019e1cb?w=400&q=80', desc:'Ice cream piled high with your choice of delicious toppings. Build your dream dessert!', customizations:[{type:'select',label:'Ice Cream Flavor',key:'flavor',options:['Strawberry','Chocolate','Vanilla']},{type:'checkboxes',label:'Toppings (choose any)',key:'toppings',options:['Chocolate Chips','Oreos','Chocolate Drizzle','Strawberries',"M&M's"]}] },
  ]
};

const CATEGORIES = [
  {id:'drinks',     label:'‚òï Drinks'},
  {id:'appetizers', label:'üçü Appetizers'},
  {id:'entrees',    label:'ü•™ Entr√©es'},
  {id:'combos',     label:'üç± Combos'},
  {id:'desserts',   label:'üç∞ Desserts'},
];

const HOT_NOW_IDS = ['en1','ap5','co1','ds2','dr5'];

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STATE  (now loaded from Firebase, not localStorage)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let cart           = JSON.parse(localStorage.getItem('crumbCart') || '[]');
let soldOutItems   = [];
let soldOutOptions = {};
let menuClosed     = false;
let currentItem    = null;
let qty            = 1;
let adminCallback  = null;
let _ordersUnsub   = null;   // Firestore listener handle

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   FIREBASE HELPERS  (wait for module to be ready)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function waitForFirebase(fn){
  if(window._firebaseReady) fn();
  else window.addEventListener('firebaseReady', fn, {once:true});
}

/* ‚îÄ‚îÄ‚îÄ Settings (sold-out + menu open/closed) ‚îÄ‚îÄ‚îÄ */
async function loadSettings(){
  try {
    const snap = await window._fsGet(window._fsDoc(window._db,'settings','main'));
    if(snap.exists()){
      const d = snap.data();
      soldOutItems   = d.soldOutItems   || [];
      soldOutOptions = d.soldOutOptions || {};
      menuClosed     = d.menuClosed     || false;
    }
  } catch(e){ console.warn('loadSettings error',e); }
  applyMenuClosedState();
  buildMenu();
}

async function saveSettings(){
  try {
    await window._fsSet(window._fsDoc(window._db,'settings','main'),{
      soldOutItems, soldOutOptions, menuClosed
    });
  } catch(e){ console.warn('saveSettings error',e); }
}

function listenToSettings(){
  window._fsOnSnap(window._fsDoc(window._db,'settings','main'), snap => {
    if(snap.exists()){
      const d = snap.data();
      soldOutItems   = d.soldOutItems   || [];
      soldOutOptions = d.soldOutOptions || {};
      menuClosed     = d.menuClosed     || false;
      applyMenuClosedState();
      buildMenu();
    }
  });
}

/* ‚îÄ‚îÄ‚îÄ Orders ‚îÄ‚îÄ‚îÄ */
function listenToOrders(){
  if(_ordersUnsub) _ordersUnsub();
  const q = window._fsQuery(window._fsColl(window._db,'orders'), window._fsOrderBy('timestamp','asc'));
  _ordersUnsub = window._fsOnSnap(q, snapshot => {
    window._allOrders = snapshot.docs.map(d => ({...d.data(), _docId: d.id}));
    renderStaffView();
    if(document.getElementById('panel-place').classList.contains('active')) renderPlaceOrder();
  });
}

async function submitOrder(){
  const name = document.getElementById('order-name')?.value?.trim();
  if(!name){ document.getElementById('order-name')?.focus(); return; }
  const order = {
    name,
    pickup: document.getElementById('order-pickup')?.value,
    notes:  document.getElementById('order-notes')?.value?.trim() || '',
    items:  cart.map(i=>({
      id:i.id, name:i.name, qty:i.qty,
      price:i.price, totalPrice:i.totalPrice,
      customStr:i.customStr||'', img:i.img
    })),
    total:  cart.reduce((s,i)=>s+i.totalPrice,0),
    timestamp: new Date().toISOString(),
    status: 'pending'
  };
  try {
    await window._fsAdd(window._fsColl(window._db,'orders'), order);
    cart=[]; saveCart(); updateCartBubble(); showToast(name); renderPlaceOrder();
  } catch(e){
    console.error('submitOrder error',e);
    alert('Could not submit order. Please try again.');
  }
}

async function markComplete(docId){
  await window._fsUpdate(window._fsDoc(window._db,'orders',docId),{status:'completed'});
}

async function _cancelOrder(docId){
  await window._fsUpdate(window._fsDoc(window._db,'orders',docId),{status:'canceled'});
}

async function _clearByStatus(status){
  const orders = (window._allOrders||[]).filter(o=>o.status===status);
  await Promise.all(orders.map(o=>window._fsDelete(window._fsDoc(window._db,'orders',o._docId))));
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   HELPERS
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function findItem(id){
  for(const cat of Object.values(MENU)){
    const f=cat.find(i=>i.id===id); if(f) return f;
  }
}
function isItemSoldOut(id){ return soldOutItems.includes(id); }
function toggleItemSoldOut(id){
  if(isItemSoldOut(id)) soldOutItems=soldOutItems.filter(i=>i!==id);
  else soldOutItems.push(id);
  saveSettings();
}
function makeOptKey(itemId,optKey,optValue){ return `${itemId}::${optKey}::${optValue}`; }
function isOptSoldOut(itemId,optKey,optValue){ return !!(soldOutOptions[makeOptKey(itemId,optKey,optValue)]); }
function toggleOptSoldOut(itemId,optKey,optValue){
  const k=makeOptKey(itemId,optKey,optValue);
  if(soldOutOptions[k]) delete soldOutOptions[k]; else soldOutOptions[k]=true;
  saveSettings();
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   BOOT
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
window.addEventListener('DOMContentLoaded',()=>{
  const bar=document.getElementById('prog-bar');
  let p=0;
  const iv=setInterval(()=>{
    p=Math.min(p+3,100); bar.style.width=p+'%';
    if(p>=100){ clearInterval(iv); setTimeout(()=>document.getElementById('loading-screen').classList.add('hidden'),300); }
  },18);
  updateCartBubble();
  waitForFirebase(()=>{
    loadSettings();
    listenToSettings();
    listenToOrders();
  });
});

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   NAVIGATION
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function showPage(name){
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.nav-link').forEach(l=>l.classList.remove('active'));
  document.querySelectorAll('.mobile-link').forEach(l=>l.classList.remove('active'));
  const page=document.getElementById('page-'+name);
  page.classList.add('active','page-enter');
  setTimeout(()=>page.classList.remove('page-enter'),500);
  document.getElementById('nav-'+name)?.classList.add('active');
  document.getElementById('mob-'+name)?.classList.add('active');
  window.scrollTo({top:0,behavior:'smooth'});
  updateMenuToggleBtnVisibility(name);
  if(name==='order') renderOrderPage();
}
function updateMenuToggleBtnVisibility(pageName){
  const btn=document.getElementById('menu-toggle-btn');
  btn.style.display=(pageName==='menu' && !menuClosed)?'flex':'none';
}
function toggleMobile(){ document.getElementById('mobile-menu').classList.toggle('open'); }
window.addEventListener('scroll',()=>{
  document.getElementById('navbar').classList.toggle('scrolled',window.scrollY>20);
});

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ADMIN PASSWORD MODAL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function openAdminModal(title,sub,icon,callback){
  adminCallback=callback;
  document.getElementById('admin-panel-content').innerHTML=`
    <div class="admin-panel-icon">${icon}</div>
    <div class="admin-panel-title">${title}</div>
    <div class="admin-panel-sub">${sub}</div>
    <input class="admin-pw-input" type="password" id="admin-pw-input" placeholder="Enter password..." onkeydown="if(event.key==='Enter')submitAdminPw()"/>
    <div class="admin-error-msg" id="admin-error"></div>
    <button class="admin-submit-btn" onclick="submitAdminPw()">Confirm ‚úì</button>
    <button class="admin-cancel-btn" onclick="closeAdminModal()">Cancel</button>`;
  document.getElementById('admin-modal-backdrop').style.display='flex';
  setTimeout(()=>document.getElementById('admin-pw-input')?.focus(),100);
}
function closeAdminModal(){
  document.getElementById('admin-modal-backdrop').style.display='none';
  adminCallback=null;
}
function handleAdminBackdrop(e){
  if(e.target===document.getElementById('admin-modal-backdrop')) closeAdminModal();
}
function submitAdminPw(){
  const inp=document.getElementById('admin-pw-input');
  const err=document.getElementById('admin-error');
  if(!inp) return;
  if(inp.value===ADMIN_PASSWORD){
    const cb=adminCallback; closeAdminModal(); if(cb) cb();
  } else {
    err.textContent='Wrong password! Try again.';
    inp.classList.remove('error'); void inp.offsetWidth; inp.classList.add('error');
    inp.value=''; inp.focus();
  }
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   86 OPTION ADMIN UI
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
let _optAdminCtx = null;

function openOptionAdmin(itemId,optKey,options){
  openAdminModal('Manage Options',"Enter the admin password to mark options as 86'd.",'‚öôÔ∏è',
    ()=>showOptionAdminPanel(itemId,optKey,options));
}
function showOptionAdminPanel(itemId,optKey,options){
  _optAdminCtx={itemId,optKey,options};
  const item=findItem(itemId);
  document.getElementById('admin-panel-content').innerHTML=`
    <div style="display:flex;align-items:center;gap:10px;margin-bottom:16px;">
      <div style="width:40px;height:40px;background:var(--brown2);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.2rem;flex-shrink:0;">‚öôÔ∏è</div>
      <div>
        <div style="font-family:'Fredoka One',cursive;font-size:1.1rem;color:var(--brown2);">${item?.name||itemId}</div>
        <div style="font-family:'Patrick Hand',cursive;font-size:0.82rem;color:#aaa;">Toggle what's 86'd ¬∑ ${optKey}</div>
      </div>
    </div>
    <div id="option-rows-container"></div>
    <button class="admin-cancel-btn" style="margin-top:10px;" onclick="closeAdminModal();if(currentItem)openModal(currentItem.id);">Done ‚úì</button>`;
  document.getElementById('admin-modal-backdrop').style.display='flex';
  renderOptionRows();
}
function renderOptionRows(){
  if(!_optAdminCtx) return;
  const{itemId,optKey,options}=_optAdminCtx;
  const container=document.getElementById('option-rows-container'); if(!container) return;
  container.innerHTML=options.map((opt,i)=>{
    const so=isOptSoldOut(itemId,optKey,opt);
    return `<div class="option-toggle-row ${so?'eighty-six':'available'}">
      <span class="option-toggle-name">${opt}${so?' <span style="font-size:0.75rem;color:#dc3545;font-family:\'Caveat\',cursive;">86\'d</span>':''}</span>
      <button class="option-toggle-btn ${so?'btn-restore':'btn-86'}" onclick="toggleOptAndRefresh(${i})">
        ${so?'‚úì Available':'86 It'}
      </button>
    </div>`;
  }).join('');
}
function toggleOptAndRefresh(optionIndex){
  if(!_optAdminCtx) return;
  const{itemId,optKey,options}=_optAdminCtx;
  toggleOptSoldOut(itemId,optKey,options[optionIndex]);
  renderOptionRows();
  refreshModalSelect(itemId,optKey,options);
}
function refreshModalSelect(itemId,optKey,options){
  const sel=document.getElementById('custom-'+optKey); if(!sel) return;
  const currentVal=sel.value;
  sel.innerHTML=options.map(opt=>{
    const so=isOptSoldOut(itemId,optKey,opt);
    return `<option value="${opt}"${so?' disabled':''}${opt===currentVal&&!so?' selected':''}>${opt}${so?" ‚Äî 86'd":''}</option>`;
  }).join('');
  if(sel.options[sel.selectedIndex]?.disabled){
    const firstOk=[...sel.options].find(o=>!o.disabled);
    if(firstOk) firstOk.selected=true;
  }
}
function triggerOptionAdmin(itemId,optKey){
  const meta=document.getElementById(`optmeta-${itemId}-${optKey}`); if(!meta) return;
  const options=JSON.parse(meta.dataset.opts);
  openOptionAdmin(itemId,optKey,options);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   MENU OPEN / CLOSE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function applyMenuClosedState(){
  const overlay=document.getElementById('menu-closed-overlay');
  menuClosed?overlay.classList.add('open'):overlay.classList.remove('open');
  const cur=document.querySelector('.page.active')?.id?.replace('page-','')||'home';
  updateMenuToggleBtnVisibility(cur);
}
function handleCloseMenu(){
  openAdminModal('Close the Menu','Enter the admin password to stop taking orders for the night.','üîí',()=>{
    menuClosed=true; saveSettings(); applyMenuClosedState();
  });
}
function handleOpenMenu(){
  openAdminModal('Open the Menu','Enter the admin password to re-open Crumb Caf√© for orders.','üîì',()=>{
    menuClosed=false; saveSettings(); applyMenuClosedState();
  });
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   BUILD MENU
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function buildMenu(){ buildCarousel(); buildCategoryTabs(); buildMenuSections(); }

function buildCarousel(){
  const track=document.getElementById('carousel-track');
  const items=HOT_NOW_IDS.map(id=>findItem(id)).filter(Boolean);
  track.innerHTML=items.map(item=>{
    const so=isItemSoldOut(item.id);
    return `<div class="carousel-card${so?' item-sold-out':''}" onclick="openModal('${item.id}')">
      <div class="carousel-img-wrap">
        <img src="${item.img}" alt="${item.name}" loading="lazy"/>
        <div class="carousel-img-overlay"></div>
        <div class="carousel-price">$${item.price.toFixed(2)}</div>
      </div>
      ${so?'<div class="carousel-sold-overlay"><div class="carousel-sold-label">üîí We\'re Out!</div></div>':''}
      <div class="carousel-card-body">
        <div class="carousel-card-name">${item.name}</div>
        <div class="carousel-card-desc">${item.desc}</div>
      </div>
    </div>`;
  }).join('');
}

function buildCategoryTabs(){
  document.getElementById('cat-tabs').innerHTML=CATEGORIES.map((c,i)=>
    `<button class="cat-tab${i===0?' active':''}" id="tab-${c.id}" onclick="scrollToSection('${c.id}')">${c.label}</button>`
  ).join('');
}

function buildMenuSections(){
  document.getElementById('menu-sections').innerHTML=CATEGORIES.map(c=>
    `<div class="menu-section" id="section-${c.id}">
      <h2 class="menu-section-title">${c.label}</h2>
      <div class="menu-items-grid">${MENU[c.id].map(item=>buildMenuItemCard(item)).join('')}</div>
    </div>`
  ).join('');
  const observer=new IntersectionObserver(entries=>{
    entries.forEach(e=>{
      if(e.isIntersecting){
        const id=e.target.id.replace('section-','');
        document.querySelectorAll('.cat-tab').forEach(t=>t.classList.remove('active'));
        document.getElementById('tab-'+id)?.classList.add('active');
      }
    });
  },{threshold:0.25});
  CATEGORIES.forEach(c=>{const el=document.getElementById('section-'+c.id);if(el)observer.observe(el);});
}

function buildMenuItemCard(item){
  const so=isItemSoldOut(item.id);
  return `<div class="menu-item-card${so?' item-sold-out':''}" id="card-${item.id}" onclick="openModal('${item.id}')">
    <div class="menu-item-thumb"><img src="${item.img}" alt="${item.name}" loading="lazy" onerror="this.style.display='none'"/></div>
    <div class="menu-item-info">
      <div class="menu-item-name">${item.name}</div>
      <div class="menu-item-desc">${item.desc||''}</div>
    </div>
    <div class="menu-item-right">
      <span class="menu-item-price">$${item.price.toFixed(2)}</span>
      ${so?'':`<button class="plus-btn">+</button>`}
    </div>
    ${so?`<div class="sold-out-overlay"><div class="sold-out-label">üîí We're Out!</div></div>`:''}
  </div>`;
}

function refreshMenuCard(itemId){
  const item=findItem(itemId); if(!item) return;
  const card=document.getElementById('card-'+itemId);
  if(card){ const tmp=document.createElement('div'); tmp.innerHTML=buildMenuItemCard(item); card.replaceWith(tmp.firstElementChild); }
  buildCarousel();
}

function scrollCarousel(dir){ document.getElementById('carousel-track').scrollBy({left:dir*300,behavior:'smooth'}); }
function scrollToSection(id){
  const el=document.getElementById('section-'+id);
  if(el) window.scrollTo({top:el.getBoundingClientRect().top+window.scrollY-150,behavior:'smooth'});
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   MODAL
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function openModal(id){
  currentItem=findItem(id); if(!currentItem) return;
  qty=1;
  document.getElementById('modal-img').src=currentItem.img;
  document.getElementById('modal-img').alt=currentItem.name;
  document.getElementById('modal-item-name').textContent=currentItem.name;
  const so=isItemSoldOut(currentItem.id);
  const lockBtn=document.getElementById('modal-lock-btn');
  if(so){
    lockBtn.textContent='üîí'; lockBtn.classList.add('locked');
    document.getElementById('modal-body-content').innerHTML=`
      <div style="text-align:center;padding:22px 0 6px;">
        <div style="font-size:3rem;margin-bottom:10px;">üòî</div>
        <div style="font-family:'Fredoka One',cursive;font-size:1.3rem;color:var(--brown2);margin-bottom:6px;">We're Out!</div>
        <div style="font-family:'Patrick Hand',cursive;font-size:1rem;color:#888;">Sorry, we've run out of this item for tonight. Check back another time!</div>
      </div>`;
  } else {
    lockBtn.textContent='üîì'; lockBtn.classList.remove('locked');
    document.getElementById('modal-body-content').innerHTML=buildModalBody(currentItem);
    updateModalPrice();
  }
  document.getElementById('item-modal').classList.add('open');
  document.body.style.overflow='hidden';
}

function buildModalBody(item){
  let html=`
    <div class="modal-price-row">
      <span class="modal-price" id="modal-price">$${item.price.toFixed(2)}</span>
      <div class="qty-row">
        <button class="qty-btn" onclick="changeQty(-1)">‚àí</button>
        <span class="qty-num" id="qty-display">1</span>
        <button class="qty-btn" onclick="changeQty(1)">+</button>
      </div>
    </div>`;
  item.customizations.forEach(c=>{
    html+=`<div class="modal-form-group"><label class="modal-label">${c.label}</label>`;
    if(c.type==='select')           html+=buildSelectField(item.id,c.key,c.options);
    else if(c.type==='checkboxes')  html+=buildCheckboxesField(item.id,c.key,c.options);
    else if(c.type==='combo-entree')html+=buildComboEntreeSelector();
    else if(c.type==='combo-appetizer')html+=buildComboAppetizer();
    html+=`</div>`;
  });
  html+=`<div class="modal-form-group">
    <label class="modal-label">Any other notes?</label>
    <textarea class="modal-textarea" id="modal-notes" rows="2" placeholder="Allergies, special requests..."></textarea>
  </div>
  <button class="modal-add-btn" id="modal-add-btn" onclick="addToCart()">Add to Order ‚Äî $${item.price.toFixed(2)}</button>`;
  return html;
}

function buildSelectField(itemId,optKey,options){
  const firstAvail=options.find(o=>!isOptSoldOut(itemId,optKey,o));
  let html=`<select class="modal-select" id="custom-${optKey}">`;
  options.forEach(opt=>{
    const so=isOptSoldOut(itemId,optKey,opt);
    html+=`<option value="${opt}"${so?' disabled':''}${opt===firstAvail&&!so?' selected':''}>${opt}${so?" ‚Äî 86'd":''}</option>`;
  });
  html+=`</select>`;
  html+=`<span id="optmeta-${itemId}-${optKey}" data-item="${itemId}" data-key="${optKey}" data-opts='${JSON.stringify(options)}' style="display:none;"></span>`;
  html+=`<button type="button" class="admin-86-link" onclick="triggerOptionAdmin('${itemId}','${optKey}')">‚öôÔ∏è Admin: mark options as 86'd</button>`;
  return html;
}

function buildCheckboxesField(itemId,optKey,options){
  let html=`<div class="toppings-grid">`;
  options.forEach(opt=>{
    const so=isOptSoldOut(itemId,optKey,opt);
    html+=`<label class="topping-check-label${so?' sold-out-topping':''}">
      <input type="checkbox" name="${optKey}" value="${opt}"${so?' disabled':''}/>
      ${opt}${so?'<span class="topping-sold-badge">86\'d</span>':''}
    </label>`;
  });
  html+=`</div>`;
  html+=`<span id="optmeta-${itemId}-${optKey}" data-item="${itemId}" data-key="${optKey}" data-opts='${JSON.stringify(options)}' style="display:none;"></span>`;
  html+=`<button type="button" class="admin-86-link" onclick="triggerOptionAdmin('${itemId}','${optKey}')">‚öôÔ∏è Admin: mark toppings as 86'd</button>`;
  return html;
}

function buildComboEntreeSelector(){
  const fiveEntrees=MENU.entrees.filter(e=>e.price===5.00);
  const twoDrinks=MENU.drinks.filter(d=>d.price===2.00);
  let html=`<div class="combo-selectors">
    <div class="combo-selector-title">ü•™ Choose an Entr√©e ($5)</div>
    <select class="modal-select" id="combo-entree-item" style="margin-bottom:10px;" onchange="updateComboDrinkCustoms('entree')">`;
  fiveEntrees.forEach(e=>{const so=isItemSoldOut(e.id);html+=`<option value="${e.id}"${so?' disabled':''}>${e.name}${so?" ‚Äî 86'd":''}</option>`;});
  html+=`</select>
    <button type="button" class="admin-86-link" onclick="openComboItemAdmin('entree-items')">‚öôÔ∏è Admin: mark entr√©es as 86'd</button>
    <div class="combo-selector-title" style="margin-top:12px;">ü•§ Choose a Drink ($2)</div>
    <select class="modal-select" id="combo-drink-item" style="margin-bottom:8px;" onchange="updateComboDrinkCustoms('entree')">`;
  twoDrinks.forEach(d=>{const so=isItemSoldOut(d.id);html+=`<option value="${d.id}"${so?' disabled':''}>${d.name}${so?" ‚Äî 86'd":''}</option>`;});
  html+=`</select>
    <button type="button" class="admin-86-link" onclick="openComboItemAdmin('entree-drinks')">‚öôÔ∏è Admin: mark drinks as 86'd</button>
    <div id="combo-drink-customs-entree" style="margin-top:8px;"></div>
  </div>`;
  return html;
}

function buildComboAppetizer(){
  const fiveApps=MENU.appetizers.filter(a=>a.price===5.00);
  const twoDrinks=MENU.drinks.filter(d=>d.price===2.00);
  let html=`<div class="combo-selectors">
    <div class="combo-selector-title">üçü Choose an Appetizer ($5)</div>
    <select class="modal-select" id="combo-app-item" style="margin-bottom:10px;" onchange="updateComboDrinkCustoms('app')">`;
  fiveApps.forEach(a=>{const so=isItemSoldOut(a.id);html+=`<option value="${a.id}"${so?' disabled':''}>${a.name}${so?" ‚Äî 86'd":''}</option>`;});
  html+=`</select>
    <button type="button" class="admin-86-link" onclick="openComboItemAdmin('app-items')">‚öôÔ∏è Admin: mark appetizers as 86'd</button>
    <div class="combo-selector-title" style="margin-top:12px;">ü•§ Choose a Drink ($2)</div>
    <select class="modal-select" id="combo-drink-item-app" style="margin-bottom:8px;" onchange="updateComboDrinkCustoms('app')">`;
  twoDrinks.forEach(d=>{const so=isItemSoldOut(d.id);html+=`<option value="${d.id}"${so?' disabled':''}>${d.name}${so?" ‚Äî 86'd":''}</option>`;});
  html+=`</select>
    <button type="button" class="admin-86-link" onclick="openComboItemAdmin('app-drinks')">‚öôÔ∏è Admin: mark drinks as 86'd</button>
    <div id="combo-drink-customs-app" style="margin-top:8px;"></div>
  </div>`;
  return html;
}

function updateComboDrinkCustoms(type){
  const drinkSelId=type==='entree'?'combo-drink-item':'combo-drink-item-app';
  const customsId=type==='entree'?'combo-drink-customs-entree':'combo-drink-customs-app';
  const prefix=type==='entree'?'ce-':'ca-';
  const container=document.getElementById(customsId); if(!container) return;
  const drinkSel=document.getElementById(drinkSelId); if(!drinkSel) return;
  const drink=findItem(drinkSel.value);
  if(!drink||!drink.customizations.length){container.innerHTML='';return;}
  let html='';
  drink.customizations.forEach(c=>{
    if(c.type==='select'){
      html+=`<div style="margin-bottom:8px;">
        <label class="modal-label" style="font-size:0.85rem;">${c.label}</label>
        <select class="modal-select" id="${prefix}custom-${c.key}" style="margin-bottom:2px;">`;
      c.options.forEach(opt=>{const so=isOptSoldOut(drinkSel.value,c.key,opt);html+=`<option value="${opt}"${so?' disabled':''}>${opt}${so?" ‚Äî 86'd":''}</option>`;});
      html+=`</select>
        <span id="optmeta-${drinkSel.value}-${c.key}" data-item="${drinkSel.value}" data-key="${c.key}" data-opts='${JSON.stringify(c.options)}' style="display:none;"></span>
        <button type="button" class="admin-86-link" onclick="triggerOptionAdmin('${drinkSel.value}','${c.key}')">‚öôÔ∏è Admin: mark options as 86'd</button>
      </div>`;
    }
  });
  container.innerHTML=html;
}

function openComboItemAdmin(comboType){
  let items=[];
  if(comboType==='entree-items') items=MENU.entrees.filter(e=>e.price===5.00);
  else if(comboType==='app-items') items=MENU.appetizers.filter(a=>a.price===5.00);
  else items=MENU.drinks.filter(d=>d.price===2.00);
  openAdminModal('Manage Combo Items',"Toggle which items are 86'd in this combo.",'‚öôÔ∏è',
    ()=>showComboItemAdminPanel(comboType,items));
}
function showComboItemAdminPanel(comboType,items){
  const label=comboType==='entree-items'?'Entr√©es':comboType==='app-items'?'Appetizers':'Drinks';
  document.getElementById('admin-panel-content').innerHTML=`
    <div style="display:flex;align-items:center;gap:10px;margin-bottom:16px;">
      <div style="width:40px;height:40px;background:var(--brown2);border-radius:12px;display:flex;align-items:center;justify-content:center;font-size:1.2rem;">‚öôÔ∏è</div>
      <div>
        <div style="font-family:'Fredoka One',cursive;font-size:1.1rem;color:var(--brown2);">Combo ${label}</div>
        <div style="font-family:'Patrick Hand',cursive;font-size:0.82rem;color:#aaa;">Toggle 86'd status</div>
      </div>
    </div>
    <div id="combo-item-rows"></div>
    <button class="admin-cancel-btn" style="margin-top:10px;" onclick="closeAdminModal();if(currentItem)openModal(currentItem.id);">Done ‚úì</button>`;
  document.getElementById('admin-modal-backdrop').style.display='flex';
  renderComboItemRows(comboType,items);
}
function renderComboItemRows(comboType,items){
  const container=document.getElementById('combo-item-rows'); if(!container) return;
  container.innerHTML=items.map((item,i)=>{
    const so=isItemSoldOut(item.id);
    return `<div class="option-toggle-row ${so?'eighty-six':'available'}">
      <span class="option-toggle-name">${item.name}${so?' <span style="font-size:0.75rem;color:#dc3545;font-family:\'Caveat\',cursive;">86\'d</span>':''}</span>
      <button class="option-toggle-btn ${so?'btn-restore':'btn-86'}" onclick="toggleComboItemAndRefresh('${item.id}','${comboType}',${i})">
        ${so?'‚úì Available':'86 It'}
      </button>
    </div>`;
  }).join('');
}
function toggleComboItemAndRefresh(itemId,comboType,idx){
  toggleItemSoldOut(itemId);
  let items=[];
  if(comboType==='entree-items') items=MENU.entrees.filter(e=>e.price===5.00);
  else if(comboType==='app-items') items=MENU.appetizers.filter(a=>a.price===5.00);
  else items=MENU.drinks.filter(d=>d.price===2.00);
  renderComboItemRows(comboType,items);
  const selId=comboType==='entree-items'?'combo-entree-item':comboType==='app-items'?'combo-app-item':comboType==='entree-drinks'?'combo-drink-item':'combo-drink-item-app';
  const sel=document.getElementById(selId); if(!sel) return;
  [...sel.options].forEach(opt=>{
    const item=findItem(opt.value); if(!item) return;
    const so=isItemSoldOut(item.id);
    opt.disabled=so; opt.textContent=item.name+(so?" ‚Äî 86'd":'');
  });
  if(sel.options[sel.selectedIndex]?.disabled){
    const firstOk=[...sel.options].find(o=>!o.disabled);
    if(firstOk) firstOk.selected=true;
  }
  refreshMenuCard(itemId);
}

function closeModal(){
  document.getElementById('item-modal').classList.remove('open');
  document.body.style.overflow='';
  currentItem=null;
}
function handleModalBackdrop(e){
  if(e.target===document.getElementById('item-modal')) closeModal();
}
function changeQty(d){
  qty=Math.max(1,qty+d);
  const el=document.getElementById('qty-display'); if(el) el.textContent=qty;
  updateModalPrice();
}
function updateModalPrice(){
  if(!currentItem) return;
  const total=(currentItem.price*qty).toFixed(2);
  const pe=document.getElementById('modal-price'); if(pe) pe.textContent='$'+total;
  const ab=document.getElementById('modal-add-btn'); if(ab) ab.textContent=`Add to Order ‚Äî $${total}`;
}

function collectCustomizations(item){
  const parts=[];
  item.customizations.forEach(c=>{
    if(c.type==='select'){
      const el=document.getElementById('custom-'+c.key);
      if(el&&el.value) parts.push(`${c.label}: ${el.value}`);
    } else if(c.type==='checkboxes'){
      const checked=[...document.querySelectorAll(`input[name="${c.key}"]:checked`)].map(i=>i.value);
      parts.push(`${c.label}: ${checked.length?checked.join(', '):'None'}`);
    } else if(c.type==='combo-entree'){
      const entEl=document.getElementById('combo-entree-item');
      const drkEl=document.getElementById('combo-drink-item');
      if(entEl&&drkEl){
        const entItem=findItem(entEl.value);
        const drkItem=findItem(drkEl.value);
        if(entItem) parts.push(`Entr√©e: ${entItem.name}`);
        if(drkItem){
          const sub=[];
          (drkItem.customizations||[]).forEach(dc=>{const cel=document.getElementById('ce-custom-'+dc.key);if(cel)sub.push(`${dc.label}: ${cel.value}`);});
          parts.push(`Drink: ${drkItem.name}${sub.length?' ('+sub.join(', ')+')':''}`);
        }
      }
    } else if(c.type==='combo-appetizer'){
      const appEl=document.getElementById('combo-app-item');
      const drkEl=document.getElementById('combo-drink-item-app');
      if(appEl&&drkEl){
        const appItem=findItem(appEl.value);
        const drkItem=findItem(drkEl.value);
        if(appItem) parts.push(`Appetizer: ${appItem.name}`);
        if(drkItem){
          const sub=[];
          (drkItem.customizations||[]).forEach(dc=>{const cel=document.getElementById('ca-custom-'+dc.key);if(cel)sub.push(`${dc.label}: ${cel.value}`);});
          parts.push(`Drink: ${drkItem.name}${sub.length?' ('+sub.join(', ')+')':''}`);
        }
      }
    }
  });
  return parts;
}

function addToCart(){
  if(!currentItem) return;
  const parts=collectCustomizations(currentItem);
  const notes=document.getElementById('modal-notes')?.value?.trim()||'';
  if(notes) parts.push(`Note: ${notes}`);
  const customStr=parts.join('\n');
  const existing=cart.find(i=>i.id===currentItem.id&&i.customStr===customStr);
  if(existing){existing.qty+=qty;existing.totalPrice=existing.price*existing.qty;}
  else cart.push({...currentItem,qty,customStr,totalPrice:currentItem.price*qty});
  saveCart(); updateCartBubble(); closeModal();
  const bubble=document.getElementById('cart-bubble');
  bubble.style.transform='scale(1.2)'; setTimeout(()=>bubble.style.transform='',200);
}

function handleItemLock(){
  if(!currentItem) return;
  const so=isItemSoldOut(currentItem.id);
  openAdminModal(
    so?'Unlock Item':'Mark as Sold Out',
    so?`Mark "${currentItem.name}" as available again.`:`Mark "${currentItem.name}" as sold out for tonight.`,
    so?'üîì':'üîí',
    ()=>{ toggleItemSoldOut(currentItem.id); refreshMenuCard(currentItem.id); closeModal(); }
  );
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   CART  (stays in localStorage ‚Äî per-device is fine for cart)
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function saveCart(){ localStorage.setItem('crumbCart',JSON.stringify(cart)); }
function updateCartBubble(){
  const bubble=document.getElementById('cart-bubble');
  const count=cart.reduce((s,i)=>s+i.qty,0);
  const total=cart.reduce((s,i)=>s+i.totalPrice,0);
  document.getElementById('bubble-count').textContent=count;
  document.getElementById('bubble-total').textContent='$'+total.toFixed(2);
  bubble.style.display=count>0?'flex':'none';
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   ORDER PAGE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function switchTab(name){
  document.querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
  document.querySelectorAll('.tab-panel').forEach(p=>p.classList.remove('active'));
  document.getElementById('tab-'+name).classList.add('active');
  document.getElementById('panel-'+name).classList.add('active');
  if(name==='staff') renderStaffView(); else renderPlaceOrder();
}
function renderOrderPage(){ renderPlaceOrder(); }

function renderPlaceOrder(){
  const el=document.getElementById('place-order-content');
  const allOrders=window._allOrders||[];
  // Show customer their recent orders
  let statusHtml='';
  if(allOrders.length>0){
    const recent=allOrders.slice(-5).reverse();
    statusHtml=`<div class="order-section-card">
      <div class="order-section-head">üìã Recent Order Status</div>
      ${recent.map(o=>`
        <div class="status-item">
          <div><div class="status-name">${o.name}</div><div class="status-sub">${o.items.length} item${o.items.length!==1?'s':''} ¬∑ $${o.total.toFixed(2)}</div></div>
          <div class="status-badge ${o.status==='completed'?'status-complete':o.status==='canceled'?'status-canceled':'status-pending'}">
            ${o.status==='completed'?'‚úÖ Ready':o.status==='canceled'?'‚ùå Canceled':'üïê In Queue'}
          </div>
        </div>`).join('')}
    </div>`;
  }
  if(cart.length===0){
    el.innerHTML=statusHtml+`<div class="empty-cart">
      <div class="empty-squirrel">üêøÔ∏è</div>
      <div class="empty-title">Your cart is empty!</div>
      <div class="empty-sub">The squirrel is waiting for your order...</div>
      <button class="btn-green" onclick="showPage('menu')" style="margin:0 auto;">‚Üê Browse Menu</button>
    </div>`; return;
  }
  const total=cart.reduce((s,i)=>s+i.totalPrice,0);
  el.innerHTML=statusHtml+`
    <div class="order-section-card">
      <div class="order-section-head">üõçÔ∏è Your Order</div>
      ${cart.map((item,i)=>`
        <div class="cart-item-row">
          <div class="cart-item-thumb"><img src="${item.img}" alt="${item.name}"/></div>
          <div class="cart-item-info">
            <div class="cart-item-name">${item.name}</div>
            ${item.customStr?`<div class="cart-item-note">${item.customStr}</div>`:''}
            <div class="cart-item-price">$${item.totalPrice.toFixed(2)}</div>
          </div>
          <div class="cart-controls">
            <button class="cart-qty-btn" onclick="updateCartQty(${i},-1)">‚àí</button>
            <span class="cart-qty">${item.qty}</span>
            <button class="cart-qty-btn" onclick="updateCartQty(${i},1)">+</button>
            <button class="remove-btn" onclick="removeCartItem(${i})">‚úï</button>
          </div>
        </div>`).join('')}
      <div class="order-total-row">
        <span class="order-total-label">Total</span>
        <span class="order-total-val">$${total.toFixed(2)}</span>
      </div>
    </div>
    <div class="order-section-card">
      <div class="order-section-head">üë§ Your Details</div>
      <div class="form-group"><label class="form-label">Name *</label><input class="form-input" id="order-name" placeholder="What should we call you?" required/></div>
      <div class="form-group"><label class="form-label">Pickup Time</label><select class="form-select" id="order-pickup"><option value="asap">ASAP</option><option value="15min">In 15 minutes</option><option value="30min">In 30 minutes</option></select></div>
      <div class="form-group"><label class="form-label">Additional Notes</label><textarea class="form-input" style="resize:none;" id="order-notes" rows="3" placeholder="Anything else we should know?"></textarea></div>
    </div>
    <button class="submit-btn" onclick="submitOrder()">üì§ Submit Order!</button>`;
}

function updateCartQty(index,delta){
  cart[index].qty=Math.max(0,cart[index].qty+delta);
  if(cart[index].qty===0) cart.splice(index,1);
  else cart[index].totalPrice=cart[index].price*cart[index].qty;
  saveCart(); updateCartBubble(); renderPlaceOrder();
}
function removeCartItem(index){ cart.splice(index,1); saveCart(); updateCartBubble(); renderPlaceOrder(); }

function showToast(name){
  const toast=document.getElementById('success-toast');
  document.getElementById('toast-sub-text').textContent=`Thanks ${name}! Head to Crumb Caf√© and pay when you arrive.`;
  toast.style.display='flex';
  setTimeout(()=>toast.style.display='none',5000);
}

/* ‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
   STAFF VIEW
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê */
function renderStaffView(){
  const el=document.getElementById('staff-content'); if(!el) return;
  const all=window._allOrders||[];
  const pending=all.filter(o=>o.status==='pending');
  const completed=all.filter(o=>o.status==='completed');
  const canceled=all.filter(o=>o.status==='canceled');
  let html='';

  html+=`<div class="queue-header">üïê Active Orders <span class="queue-count">(${pending.length})</span></div>`;
  if(pending.length===0){
    html+=`<div class="empty-queue"><div style="font-size:3rem;margin-bottom:10px;">üêøÔ∏è</div><div style="font-family:'Fredoka One',cursive;font-size:1.2rem;color:var(--brown2);margin-bottom:5px;">No orders yet!</div><div style="font-family:'Patrick Hand',cursive;color:#aaa;font-size:0.9rem;">The squirrel is waiting... üêøÔ∏è</div></div>`;
  } else {
    html+=`<div class="order-cards-grid">`;
    pending.forEach(order=>{
      html+=`<div class="order-card">
        <div class="order-card-header">
          <div><div class="order-card-name">${order.name}</div><div class="order-card-time">${new Date(order.timestamp).toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'})}${order.pickup!=='asap'?' ¬∑ '+order.pickup:''}</div></div>
          <div class="order-price-badge">$${order.total.toFixed(2)}</div>
        </div>
        <div style="margin-bottom:10px;">
          ${order.items.map(item=>`
            <div class="order-item-row">
              <span class="order-item-qty">${item.qty}</span>
              <div>
                <div class="order-item-name">${item.name}</div>
                ${item.customStr?`<div class="order-item-customizations">${item.customStr.replace(/\n/g,' ¬∑ ')}</div>`:''}
              </div>
            </div>`).join('')}
        </div>
        ${order.notes?`<div class="order-extra-note">"${order.notes}"</div>`:''}
        <button class="mark-complete-btn" onclick="markComplete('${order._docId}')">‚úì Mark as Complete</button>
        <button class="cancel-order-btn" onclick="handleCancelOrder('${order._docId}','${order.name}')">‚úï Cancel Ticket</button>
      </div>`;
    });
    html+=`</div>`;
  }

  if(completed.length>0){
    html+=`<div class="queue-header" style="margin-top:28px;">‚úÖ Completed <span class="queue-count">(${completed.length})</span></div>`;
    html+=`<div class="completed-cards">${completed.map(o=>`<div class="completed-card"><span class="completed-check">‚úì</span><div class="completed-name">${o.name}</div><div class="completed-sub">${o.items.length} item${o.items.length!==1?'s':''} ¬∑ $${o.total.toFixed(2)}</div></div>`).join('')}</div>`;
    html+=`<button class="clear-completed-btn" onclick="handleClearCompleted()">üóëÔ∏è Clear Completed Orders</button>`;
  }

  if(canceled.length>0){
    html+=`<div class="queue-header" style="margin-top:28px;">‚ùå Canceled <span class="queue-count">(${canceled.length})</span></div>`;
    html+=`<div class="canceled-cards">${canceled.map(o=>`<div class="canceled-card"><span class="canceled-x">‚úï</span><div class="canceled-name">${o.name}</div><div class="canceled-sub">${o.items.length} item${o.items.length!==1?'s':''} ¬∑ $${o.total.toFixed(2)}</div></div>`).join('')}</div>`;
    html+=`<button class="clear-completed-btn" style="border-color:rgba(220,53,69,0.3);" onclick="handleClearCanceled()">üóëÔ∏è Clear Canceled Orders</button>`;
  }

  el.innerHTML=html;
}

function handleCancelOrder(docId,name){
  openAdminModal('Cancel Ticket',`Enter the admin password to cancel ${name}'s order.`,'‚úï',()=>{
    _cancelOrder(docId);
  });
}
function handleClearCompleted(){
  openAdminModal('Clear Completed Orders','Enter the admin password to permanently delete all completed orders.','üóëÔ∏è',()=>{
    _clearByStatus('completed');
  });
}
function handleClearCanceled(){
  openAdminModal('Clear Canceled Orders','Enter the admin password to permanently delete all canceled orders.','üóëÔ∏è',()=>{
    _clearByStatus('canceled');
  });
}
</script>
</body>
</html>